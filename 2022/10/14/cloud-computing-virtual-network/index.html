<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Cloud Computing - Virtual network | ByteCoding</title><meta name="author" content="zhongmingmao"><meta name="copyright" content="zhongmingmao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="VPC Virtual Private Cloud：构建在云上，相互隔离，用户可以自主控制的私有网络环境     概念 描述    网段 私有网络的内部 IP 区段，通常采用 CIDR 表达   子网 私有网络的下级网络结构，一个私有网络可以划分出多个子网，阿里云将子网称为交换机   路由表 定义私有网络内流量的路由规则，每个子网都必须有一张关联的路由表（自动创建默认路由表）   网关 是对进出私">
<meta property="og:type" content="article">
<meta property="og:title" content="Cloud Computing - Virtual network">
<meta property="og:url" content="https://blog.zhongmingmao.top/2022/10/14/cloud-computing-virtual-network/index.html">
<meta property="og:site_name" content="ByteCoding">
<meta property="og:description" content="VPC Virtual Private Cloud：构建在云上，相互隔离，用户可以自主控制的私有网络环境     概念 描述    网段 私有网络的内部 IP 区段，通常采用 CIDR 表达   子网 私有网络的下级网络结构，一个私有网络可以划分出多个子网，阿里云将子网称为交换机   路由表 定义私有网络内流量的路由规则，每个子网都必须有一张关联的路由表（自动创建默认路由表）   网关 是对进出私">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/aws-vpc.jpg">
<meta property="article:published_time" content="2022-10-13T16:06:25.000Z">
<meta property="article:modified_time" content="2023-05-24T14:10:51.203Z">
<meta property="article:author" content="zhongmingmao">
<meta property="article:tag" content="Cloud Computing">
<meta property="article:tag" content="IaaS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/aws-vpc.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Cloud Computing - Virtual network",
  "url": "https://blog.zhongmingmao.top/2022/10/14/cloud-computing-virtual-network/",
  "image": "https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/aws-vpc.jpg",
  "datePublished": "2022-10-13T16:06:25.000Z",
  "dateModified": "2023-05-24T14:10:51.203Z",
  "author": [
    {
      "@type": "Person",
      "name": "zhongmingmao",
      "url": "https://blog.zhongmingmao.top"
    }
  ]
}</script><link rel="shortcut icon" href="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="canonical" href="https://blog.zhongmingmao.top/2022/10/14/cloud-computing-virtual-network/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":32,"languages":{"author":"Author: zhongmingmao","link":"Link: ","source":"Source: ByteCoding","info":"Copyright belongs to the author. For commercial use, please contact the author for authorization. For non-commercial use, please indicate the source."}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Cloud Computing - Virtual network',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ByteCoding" type="application/atom+xml">
</head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/url(https:/cdn.pixabay.com/photo/2021/07/20/03/39/fisherman-6479663_1280.jpg));"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">639</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">191</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">83</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/aws-vpc.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ByteCoding</span></a><a class="nav-page-title" href="/"><span class="site-name">Cloud Computing - Virtual network</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Cloud Computing - Virtual network</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">Created</span><time datetime="2022-10-13T16:06:25.000Z" title="Created 2022-10-14 00:06:25">2022-10-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/cloud-computing/">Cloud Computing</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/cloud-computing/iaas/">IaaS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">920</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>2mins</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:512,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2023-05-24 22:10:51&quot;}" hidden></div><h1 id="VPC"><a href="#VPC" class="headerlink" title="VPC"></a>VPC</h1><blockquote>
<p><code>Virtual Private Cloud</code>：构建在<code>云</code>上，相互<code>隔离</code>，用户可以<code>自主控制</code>的<code>私有</code>网络环境</p>
</blockquote>
<table>
<thead>
<tr>
<th>概念</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>网段</code></td>
<td>私有网络的内部 IP 区段，通常采用 <code>CIDR</code> 表达</td>
</tr>
<tr>
<td><code>子网</code></td>
<td>私有网络的<code>下级网络结构</code>，一个私有网络可以划分出<code>多个子网</code>，阿里云将子网称为<code>交换机</code></td>
</tr>
<tr>
<td><code>路由表</code></td>
<td>定义私有网络内<code>流量的路由规则</code>，每个<code>子网</code>都必须有一张<code>关联的路由表</code>（自动创建<code>默认路由表</code>）</td>
</tr>
<tr>
<td><code>网关</code></td>
<td>是对<code>进出</code>私有网络的流量进行<code>把守</code>和<code>分发</code>的重要节点</td>
</tr>
<tr>
<td><code>安全组</code></td>
<td>私有网络内<code>虚拟机</code>进出流量的<code>通行或拦截规则</code>，相当于虚拟机<code>外层</code>的<code>网络防火墙</code></td>
</tr>
</tbody></table>
<span id="more"></span>

<blockquote>
<p>VPC 属于<code>局域网</code>，VPC 创建成功后，<code>网段无法修改</code>，至少要创建一个<code>子网</code>（<code>交换机</code>）（网段也不能变更）</p>
</blockquote>
<blockquote>
<p>可以建立<code>跨可用区</code>的私有网络<br>高可用：让主力集群在一个可用区工作，备用集群在另一个可用区随时待命，按需切换</p>
</blockquote>
<blockquote>
<p>关键：<code>提前规划</code> VPC 和各子网的<code>网段</code><br>在没有 VPC 的情况下创建虚拟机，一般会<code>自动生成 VPC</code> – 生产慎用！</p>
</blockquote>
<h1 id="VM"><a href="#VM" class="headerlink" title="VM"></a>VM</h1><blockquote>
<p>VM 通过<code>弹性网卡</code>（Elastic network interface，<code>ENI</code>）来与 VPC 连接<br><code>ENI</code> 一方面与 <code>VM</code> 绑定，另一方面则嵌入到某个 <code>VPC</code> 中的某个 <code>vSwitch</code>（拥有最少一个<code>私有 IP</code>）</p>
</blockquote>
<blockquote>
<p><code>弹性</code>网卡（<code>ENI</code>）</p>
</blockquote>
<ol>
<li>一个 VM 可以<code>绑定多块网卡</code>，区分<code>主网卡</code>和<code>辅助网卡</code></li>
<li>一块网卡<code>隶属</code>于一个<code>子网</code>，可以配置<code>同一子网内的多个私有 IP</code></li>
<li><code>辅助网卡</code>可以<code>动态解绑</code>，并能绑定到<code>另一台 VM</code> 上</li>
</ol>
<blockquote>
<p>创建 VM 时选择 <code>VPC</code> 中的某个<code>vSwitch</code>：新 VM <code>自动生成的主网卡</code>，接入了<code>所选 VPC</code> 的<code>所选 vSwitch</code></p>
</blockquote>
<h1 id="公网-IP"><a href="#公网-IP" class="headerlink" title="公网 IP"></a>公网 IP</h1><blockquote>
<p>在<code>生产</code>环境，<code>不要依赖</code>自动生成的公网 IP，推荐使用<code>弹性 IP</code>（Elastic IP，<code>EIP</code>）<br><code>自动生成</code>的本质：从公有云的 <code>IP 池</code>中<code>临时租用</code>，如果 VM 关闭或者重启，下次获得公网 IP 可能是不同的</p>
</blockquote>
<p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/image-20230524194102521.png" alt="image-20230524194102521"></p>
<blockquote>
<p>弹性 IP <code>一旦生成</code>，它所对应的 <code>IP</code> 是<code>固定</code>的，适合需要<code>稳定 IP</code> 的生产环境<br>弹性的语义：可以非常<code>自由</code>地<code>解绑</code>和<code>再次绑定</code>到<code>任意目标</code>（拥有了该 IP 的<code>所有权</code>）</p>
</blockquote>
<h1 id="网关"><a href="#网关" class="headerlink" title="网关"></a>网关</h1><blockquote>
<p>弹性 IP 是<code>双向</code>的</p>
</blockquote>
<blockquote>
<p>网关：用来统一协调管理私有网络<code>与外部通信</code>的组件</p>
</blockquote>
<h2 id="NAT"><a href="#NAT" class="headerlink" title="NAT"></a>NAT</h2><blockquote>
<p>Network Address <code>Translation</code>：允许多台<code>没有公网 IP</code> 的虚拟机访问外网</p>
</blockquote>
<h3 id="SNAT"><a href="#SNAT" class="headerlink" title="SNAT"></a>SNAT</h3><blockquote>
<p><code>源地址</code>转换（<code>从内到外</code>的单向连通）：让私有网络的虚拟机<code>共享某个公网 IP</code> 接入互联网</p>
</blockquote>
<h2 id="VPN"><a href="#VPN" class="headerlink" title="VPN"></a>VPN</h2><blockquote>
<p>VPN 能够<code>基于互联网</code>提供<code>私有加密</code>的通信，非常适合用来从<code>任意其他私有设施</code>安全地连接到 VPC</p>
</blockquote>
<h1 id="多-VPC"><a href="#多-VPC" class="headerlink" title="多 VPC"></a>多 VPC</h1><ol>
<li>VPC 和 VPC 的互联，推荐使用<code>对等连接</code>（VPC <code>Peering</code>）	<ul>
<li>能够在<code>不添加额外设备</code>的情况下，让两个 VPC 无缝互联，并且支持<code>跨区域</code></li>
</ul>
</li>
<li>VPC Peering 的实施前提：两个 VPC 的<code>网段没有交集</code></li>
<li>VPC Peering <code>不具备传递性</code>，如果需要多 VPC 间任意路径的互联互通，则需要更为复杂和强大的<code>专用网络设施</code></li>
</ol>
<h1 id="混合云"><a href="#混合云" class="headerlink" title="混合云"></a>混合云</h1><blockquote>
<p>公有云中的私有网络，可以与企业本地数据中心进行互联</p>
</blockquote>
<ol>
<li>先考虑使用<code>轻量</code>的 <code>VPN</code> 方式：通过<code>公网</code>线路为两边建立连接渠道</li>
<li>如果需要保证<code>延迟</code>和<code>带宽</code>，一般需要<code>专线</code>进行连接</li>
<li><code>高可用</code>：专线 + VPN - 组合</li>
</ol>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://blog.zhongmingmao.top">zhongmingmao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://blog.zhongmingmao.top/2022/10/14/cloud-computing-virtual-network/">https://blog.zhongmingmao.top/2022/10/14/cloud-computing-virtual-network/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/cloud-computing/">Cloud Computing</a><a class="post-meta__tags" href="/tags/iaas/">IaaS</a></div><div class="post-share"><div class="social-share" data-image="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/aws-vpc.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/10/15/cloud-computing-auto-scaling/" title="Cloud Computing - Auto scaling"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/AutoScalingGraphic.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Cloud Computing - Auto scaling</div></div><div class="info-2"><div class="info-item-1">Design for Failure 核心思路：冗余 + 快速切换   宿主机 保证多个虚拟机不在同一个宿主机上，甚至不处于同一个机架上 提供物理分散分布的能力：AWS（Placement Group）、Azure（Availability Set）、阿里云（部署集）   可用区 - IDC 多可用区的实例部署（VPC 支持跨可用区）   区域 多区架构层面的相关预案 互联网业务：通过 DNS 导流，将域名解析到另一个区域的备用服务，底层数据依赖日常的跨区域的实时同步   多云 - 避免厂商锁定    Auto scaling 应对工作负载洪峰 + 在低谷期显著降低成本  虚拟机编组 将功能相同的多个虚拟机，作为一个单位来创建、管理和伸缩   弹性伸缩服务 根据指定的数量和扩缩容的规则，动态地创建和销毁虚拟机实例，协调虚拟机的生命周期   负载均衡器 - SLB 将流量均匀地、或者按照一定权重或规则，分发到多台虚拟机上     弹性伸缩服务 + 负载均衡器：适合处理无状态类的计算需求  </div></div></div></a><a class="pagination-related" href="/2022/10/13/cloud-computing-cloud-disk/" title="Cloud Computing - Cloud disk"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/940e9395-cloud-storage.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Cloud Computing - Cloud disk</div></div><div class="info-2"><div class="info-item-1">概念 云硬盘：云虚拟机可以挂载和使用的硬盘（系统盘 + 数据盘） 将云端磁盘服务称为块存储（Block Storage），与 Linux 中的块设备相对应，可以格式化并施加文件系统 数据持久化 （非易失性存储）：最少三副本，高可用，极少发生数据丢失 但不能完全依赖云硬盘的可靠性，应该进行额外的备份   云硬盘和传统硬盘的核心差异：绝大多数的云硬盘都是远程的 – 计算存储分离 在云端，虚拟机的硬盘大概率不在宿主机上，而是在专用的磁盘服务器阵列中 通过云数据中心内部的特有 IO 线路进行连接 IO 优化实例 对云虚拟机和云硬盘之间的网络传输，进行了软硬件层面的优化，进而充分发挥所挂载磁盘的性能        性能 性能指标：IOPS、吞吐量、访问延时等   最终性能受存储介质和容量大小共同影响  等级 存储介质  基于 HDD 性能一般，最高 IOPS 大概在数百左右，但成本低  基于 SSD / HDD IOPS 在数千左右，通常为默认选项，综合发挥 SSD 的性能优势和 HDD 的容量优势  基于 SSD IOPS 能够上万，有非常稳定的 IO 能力，用来承载关键业务或者数据库等 IO 密集型应用  基...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2022/10/15/cloud-computing-auto-scaling/" title="Cloud Computing - Auto scaling"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/AutoScalingGraphic.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-15</div><div class="info-item-2">Cloud Computing - Auto scaling</div></div><div class="info-2"><div class="info-item-1">Design for Failure 核心思路：冗余 + 快速切换   宿主机 保证多个虚拟机不在同一个宿主机上，甚至不处于同一个机架上 提供物理分散分布的能力：AWS（Placement Group）、Azure（Availability Set）、阿里云（部署集）   可用区 - IDC 多可用区的实例部署（VPC 支持跨可用区）   区域 多区架构层面的相关预案 互联网业务：通过 DNS 导流，将域名解析到另一个区域的备用服务，底层数据依赖日常的跨区域的实时同步   多云 - 避免厂商锁定    Auto scaling 应对工作负载洪峰 + 在低谷期显著降低成本  虚拟机编组 将功能相同的多个虚拟机，作为一个单位来创建、管理和伸缩   弹性伸缩服务 根据指定的数量和扩缩容的规则，动态地创建和销毁虚拟机实例，协调虚拟机的生命周期   负载均衡器 - SLB 将流量均匀地、或者按照一定权重或规则，分发到多台虚拟机上     弹性伸缩服务 + 负载均衡器：适合处理无状态类的计算需求  </div></div></div></a><a class="pagination-related" href="/2022/10/13/cloud-computing-cloud-disk/" title="Cloud Computing - Cloud disk"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/940e9395-cloud-storage.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-13</div><div class="info-item-2">Cloud Computing - Cloud disk</div></div><div class="info-2"><div class="info-item-1">概念 云硬盘：云虚拟机可以挂载和使用的硬盘（系统盘 + 数据盘） 将云端磁盘服务称为块存储（Block Storage），与 Linux 中的块设备相对应，可以格式化并施加文件系统 数据持久化 （非易失性存储）：最少三副本，高可用，极少发生数据丢失 但不能完全依赖云硬盘的可靠性，应该进行额外的备份   云硬盘和传统硬盘的核心差异：绝大多数的云硬盘都是远程的 – 计算存储分离 在云端，虚拟机的硬盘大概率不在宿主机上，而是在专用的磁盘服务器阵列中 通过云数据中心内部的特有 IO 线路进行连接 IO 优化实例 对云虚拟机和云硬盘之间的网络传输，进行了软硬件层面的优化，进而充分发挥所挂载磁盘的性能        性能 性能指标：IOPS、吞吐量、访问延时等   最终性能受存储介质和容量大小共同影响  等级 存储介质  基于 HDD 性能一般，最高 IOPS 大概在数百左右，但成本低  基于 SSD / HDD IOPS 在数千左右，通常为默认选项，综合发挥 SSD 的性能优势和 HDD 的容量优势  基于 SSD IOPS 能够上万，有非常稳定的 IO 能力，用来承载关键业务或者数据库等 IO 密集型应用  基...</div></div></div></a><a class="pagination-related" href="/2022/10/12/cloud-computing-vm/" title="Cloud Computing - Virtual machine"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/c2jc06l6fp3zzg52fl01.webp" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-12</div><div class="info-item-2">Cloud Computing - Virtual machine</div></div><div class="info-2"><div class="info-item-1">体系结构 计算存储分离   传统虚拟化 对单一物理机器资源的纵向分割，计算、存储、网络等能力都是一台物理机的子集，可伸缩性有较大局限   云虚拟机 云端有大规模的专属硬件和高速的内部网络 除了核心的 CPU 和内存仍属于同一台宿主机外，硬盘和网络等可以享受云端的基础设施 在可扩展性（硬盘、网卡、公网 IP）和故障隔离方面，有很大优势 名称 阿里云：ECS - Elastic Compute Service AWS：EC2 - Elastic Compute Cloud Azure：Virtual Machines 腾讯云：CVM - Cloud Virtual Machine         网络安全组 Network Security Group   网络安全组：一层覆盖在虚拟机之外的网络防火墙，能够控制虚拟机入站流量和出站流量 网络安全组并不工作在 OS 层，是额外的一层防护，非法流量不会到达 OS 的网络堆栈，不会影响 VM 的性能 网络安全组是一种可复用的配置，可以同时应用于多个虚拟机，软件定义网络 网络安全组非常灵活，规则会动态生效  类型规格类型 具有同一类设计目的或者性能特点的虚拟机类别：...</div></div></div></a><a class="pagination-related" href="/2022/10/09/cloud-computing-region-availability-zone/" title="Cloud Computing - Region + Availability zone"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/featured-image-cloud-computing.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-09</div><div class="info-item-2">Cloud Computing - Region + Availability zone</div></div><div class="info-2"><div class="info-item-1">Region 云计算厂商在某个地理位置提供的所有云服务的组合，是厂商对外提供云服务的基本单位和容器 绝大多数的云服务，通常都会按照 Region 进行部署 用户使用的所有云资源，都会隶属于某个 Region，通常在创建资源时确定   每个 Region 都会有个由字母数字构成的 Region 代号（Region ID or Region Code），一般为全局唯一 Region 的设立与分布，体现了云厂商的业务重点和地区倾向 不同 Region 之间的距离，一般为数百公里或以上   Region 的选址思路 人口稠密的中心城市 - 离用户和商业更近 相对偏远的地区 - 维护成本低      选择 Region 地理位置 尽可能地靠近应用所面向的最终用户 混合云架构（本地数据中心与云端互联） 混合云的专线接入，一般以同城或短距离接入为主（控制费用 + 提高线路稳定性）     Region 之间云服务的差异 同一个云在不同的 Region，所能提供的服务和规模可能是不同的 Region 的服役时间，往往与 Region 内云服务的可用性有较大的关联 新 Region - 最新的硬件和云端服务 旧 Regi...</div></div></div></a><a class="pagination-related" href="/2022/10/21/cloud-computing-serverless/" title="Cloud Computing - Serverless"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/serverless.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-21</div><div class="info-item-2">Cloud Computing - Serverless</div></div><div class="info-2"><div class="info-item-1">Serverless vs Container Serverless 是云计算中资源抽象的极致体现：用户专注于业务逻辑，而无需关注基础设施   Container 给予了用户很大的定制空间，按需对应用进行拆分和封装   Serverless 完全屏蔽了计算资源，引导用户不再关注基础设施，只需遵循标准的方式编写业务代码即可 更细的拆分粒度 FaaS：将每一个具有独立功能的函数，作为一个单独的服务进行部署和运行        计费机制 底层没有固化的资源，一般会按照调用次数和调用时长来计费，可以精确到毫秒 从成本上，非常适合那些偶尔触发、短时间运行的工作负载  事件模型 事件模型是 Serverless 的核心编程模型和运行逻辑，非常适合基于事件驱动的开发场景   上游：触发器 Serverless 一般都会提供多种触发器：API 触发器、OSS 触发器、MQ 触发器、定时触发器等   下游 在函数内访问其他云服务（如 RDS、MQ 等外部存储） Serverless Computing 本身是无状态的，所有持久化需求都需要借助外部存储来实现   架构范式 FaaS + MQ：关注数据流，是数据的传递和流向...</div></div></div></a><a class="pagination-related" href="/2022/10/20/cloud-computing-container/" title="Cloud Computing - Container"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cloud-computing-1253868755.cos.ap-guangzhou.myqcloud.com/Xoriant-Modern-Container-Orchestration-Platform.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2022-10-20</div><div class="info-item-2">Cloud Computing - Container</div></div><div class="info-2"><div class="info-item-1">历史 相辅相成：云承载着容器的运行，容器生态驱动着云的发展   初期的首要目标：Docker 容器在云上能够顺畅运行 帮助用户创建底层虚拟机集群，免去用户自己手动管理虚拟机的麻烦   随着容器应用的复杂化，容器编排成为了用户最迫切的需求 Kubernetes 赢得了编排框架大战，成为了事实标准      自建 vs 托管 由于云端的多租户特性，云平台会统一提供和托管 Master 节点，降低运维成本 只需要创建 Worker 节点，并为之付费即可   Kubernetes 的抽象设计非常出色，能够支持大量灵活的扩展 云厂商会让尽量多的 IaaS 和 PaaS 功能组件，渗透到 Kubernetes 的体系中 Cloud Service Operator 通过云服务来扩展 Kubernetes 的能力，并反过来使用 Kubernetes 来管理这些云服务 成熟：容器和云一体化架构     多集群 降低了建立 Kubernetes 集群的门槛，如果业务关联较小，可以为不同的业务创建单独的 Kubernetes 集群    全托管 容器服务实例，无需关心底层基础设施   适合场景：只有一个容器镜像，且为无状态...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">zhongmingmao</div><div class="author-info-description">Focus on Infrastructure.</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">639</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">191</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">83</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Things are always unexpected!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#VPC"><span class="toc-number">1.</span> <span class="toc-text">VPC</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VM"><span class="toc-number">2.</span> <span class="toc-text">VM</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AC%E7%BD%91-IP"><span class="toc-number">3.</span> <span class="toc-text">公网 IP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E5%85%B3"><span class="toc-number">4.</span> <span class="toc-text">网关</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#NAT"><span class="toc-number">4.1.</span> <span class="toc-text">NAT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SNAT"><span class="toc-number">4.1.1.</span> <span class="toc-text">SNAT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VPN"><span class="toc-number">4.2.</span> <span class="toc-text">VPN</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%9A-VPC"><span class="toc-number">5.</span> <span class="toc-text">多 VPC</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E4%BA%91"><span class="toc-number">6.</span> <span class="toc-text">混合云</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/21/cloud-native-observability-opentelemetry-java-zero-code/" title="Observability - OpenTelemetry Java Zero Code"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://observability-1253868755.cos.ap-guangzhou.myqcloud.com/otel-java-agent.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Observability - OpenTelemetry Java Zero Code"/></a><div class="content"><a class="title" href="/2025/01/21/cloud-native-observability-opentelemetry-java-zero-code/" title="Observability - OpenTelemetry Java Zero Code">Observability - OpenTelemetry Java Zero Code</a><time datetime="2025-01-20T16:06:25.000Z" title="Created 2025-01-21 00:06:25">2025-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/20/cloud-native-observability-opentelemetry-java/" title="Observability - OpenTelemetry Java"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://observability-1253868755.cos.ap-guangzhou.myqcloud.com/otel-java.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Observability - OpenTelemetry Java"/></a><div class="content"><a class="title" href="/2025/01/20/cloud-native-observability-opentelemetry-java/" title="Observability - OpenTelemetry Java">Observability - OpenTelemetry Java</a><time datetime="2025-01-19T16:06:25.000Z" title="Created 2025-01-20 00:06:25">2025-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/19/ai-agent-overview-mcp/" title="AI Agent - MCP Overview"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ai-agent-1253868755.cos.ap-guangzhou.myqcloud.com/mcp.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI Agent - MCP Overview"/></a><div class="content"><a class="title" href="/2025/01/19/ai-agent-overview-mcp/" title="AI Agent - MCP Overview">AI Agent - MCP Overview</a><time datetime="2025-01-18T16:06:25.000Z" title="Created 2025-01-19 00:06:25">2025-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/18/ai-agent-overview/" title="AI Agent - Overview"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ai-agent-1253868755.cos.ap-guangzhou.myqcloud.com/ai-agent.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AI Agent - Overview"/></a><div class="content"><a class="title" href="/2025/01/18/ai-agent-overview/" title="AI Agent - Overview">AI Agent - Overview</a><time datetime="2025-01-17T16:06:25.000Z" title="Created 2025-01-18 00:06:25">2025-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/17/new-java-feature-foreign-function-api/" title="New Java Feature - Foreign Function API"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/Java-Foreign-Function-API.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Foreign Function API"/></a><div class="content"><a class="title" href="/2025/01/17/new-java-feature-foreign-function-api/" title="New Java Feature - Foreign Function API">New Java Feature - Foreign Function API</a><time datetime="2025-01-16T16:06:25.000Z" title="Created 2025-01-17 00:06:25">2025-01-17</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2015 - 2025 By zhongmingmao</span></div><div class="footer_custom_text">Life is like a box of chocolates. You can't know what you'll eat until you open it.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script></div></body></html>