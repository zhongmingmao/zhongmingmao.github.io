<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>ByteCoding</title><meta name="author" content="zhongmingmao"><meta name="copyright" content="zhongmingmao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Focus on Infrastructure">
<meta property="og:type" content="website">
<meta property="og:title" content="ByteCoding">
<meta property="og:url" content="https://blog.zhongmingmao.top/page/4/index.html">
<meta property="og:site_name" content="ByteCoding">
<meta property="og:description" content="Focus on Infrastructure">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png">
<meta property="article:author" content="zhongmingmao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="shortcut icon" href="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="canonical" href="https://blog.zhongmingmao.top/page/4/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":512,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":256},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":32,"languages":{"author":"Author: zhongmingmao","link":"Link: ","source":"Source: ByteCoding","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ByteCoding',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-08-09 20:58:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ByteCoding" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">634</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">189</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">80</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2022/10/16/13/53/early-morning-7525151_1280.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="ByteCoding"><span class="site-name">ByteCoding</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">ByteCoding</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2024/10/04/bigdata-beam-streaming/" title="Beam - Streaming"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-streaming.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Streaming"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/04/bigdata-beam-streaming/" title="Beam - Streaming">Beam - Streaming</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-10-03T16:06:25.000Z" title="Created 2024-10-04 00:06:25">2024-10-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">有界数据 vs 无界数据
在 Beam 中，可以用同一个 Pipeline 处理有界数据和无界数据
无论是有界数据还是无界数据，在 Beam 中，都可以用窗口把数据按时间分割成一些有限大小的集合
对于无界数据，必须使用窗口对数据进行分割，然后对每个窗口内的数据集进行处理





读取无界数据
withLogAppendTime - 使用 Kafka 的 log append time 作为 PCollection 的时间戳

12345678Pipeline pipeline = Pipeline.create();pipeline.apply(    KafkaIO.&lt;String, String&gt;read()        .withBootstrapServers(&quot;broker_1:9092,broker_2:9092&quot;)        .withTopic(&quot;shakespeare&quot;) // use withTopics(List&lt;String&gt;) to read from multiple topics.        .withK ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/10/03/bigdata-beam-window/" title="Beam - Window"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-window.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Window"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/03/bigdata-beam-window/" title="Beam - Window">Beam - Window</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-10-02T16:06:25.000Z" title="Created 2024-10-03 00:06:25">2024-10-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">Window
在 Beam 中，Window 将 PCollection 里的每个元素根据时间戳划分成不同的有限数据集合
要将一些聚合操作应用在 PCollection 上时，或者对不同的 PCollection 进行 Join 操作
Beam 将这些操作应用在这些被 Window 划分好的不同的数据集上


无论是有界数据还是无界数据，Beam 都会按同样的规则进行处理
在用 IO Connector 读取有界数据集的过程中，Read Transform 会默认为每个元素分配一个相同的时间戳
一般情况下，该时间戳为运行 Pipeline 的时间，即处理时间 - Processing Time
Beam 会为该 Pipeline 默认分配一个全局窗口 - Global Window - 从无限小到无限大的时间窗口





Global Window
可以显式将一个全局窗口赋予一个有界数据集

12PCollection&lt;String&gt; input = p.apply(TextIO.read().from(filepath));PCollection&lt;String&gt; batchInpu ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/10/02/bigdata-beam-wordcount/" title="Beam - WordCount"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/simple-wordcount-pipeline.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - WordCount"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/02/bigdata-beam-wordcount/" title="Beam - WordCount">Beam - WordCount</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-10-01T16:06:25.000Z" title="Created 2024-10-02 00:06:25">2024-10-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">步骤
用 Pipeline IO 读取文本
用 Transform 对文本进行分词和词频统计
用 Pipeline IO 输出结果
将所有步骤打包成一个 Pipeline




创建 Pipeline
默认情况下，将采用 DirectRunner 在本地运行

1PipelineOptions options = PipelineOptionsFactory.create();


一个 Pipeline 实例会构建数据处理的 DAG，以及这个 DAG 所需要的 Transform

1Pipeline p = Pipeline.create(options);

应用 Transform
TextIO.Read - 读取外部文件，生成一个 PCollection，包含所有文本行，每个元素都是文本中的一行

123String filepattern =    &quot;file:///Users/zhongmingmao/workspace/java/hello-beam/corpus/shakespeare.txt&quot;;PCollection&lt;String&gt; lines = p.a ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/10/01/bigdata-beam-execution-engine/" title="Beam - Execution Engine"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/flink-runner-beam-language-portability.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Execution Engine"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/10/01/bigdata-beam-execution-engine/" title="Beam - Execution Engine">Beam - Execution Engine</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-30T16:06:25.000Z" title="Created 2024-10-01 00:06:25">2024-10-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">Pipeline
读取输入数据到 PCollection
对读进来的 PCollection 进行 Transform，得到另一个 PCollection
输出结果 PCollection



1234567891011121314// Start by defining the options for the pipeline.PipelineOptions options = PipelineOptionsFactory.create();// Then create the pipeline.Pipeline pipeline = Pipeline.create(options);PCollection&lt;String&gt; lines = pipeline.apply(  &quot;ReadLines&quot;, TextIO.read().from(&quot;gs://some/inputData.txt&quot;));PCollection&lt;String&gt; filteredLines = lines.apply(new FilterLines());filteredLi ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/30/bigdata-beam-pipeline-test/" title="Beam - Pipeline Test"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-pipeline-test.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Pipeline Test"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/30/bigdata-beam-pipeline-test/" title="Beam - Pipeline Test">Beam - Pipeline Test</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-29T16:06:25.000Z" title="Created 2024-09-30 00:06:25">2024-09-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">Context
设计好的 Pipeline 通常需要放在分布式环境下执行，具体每一步的 Transform 都会被分配到任意机器上执行
如果 Pipeline 运行出错，则需要定位到具体机器，再到上面去做调试是不现实的
另一种办法，读取一些样本数据集，再运行整个 Pipeline 去验证哪一步逻辑出错 - 费时费力
正式将 Pipeline 放在分布式环境上运行之前，需要先完整地测试整个 Pipeline 逻辑



Solution
Beam 提供了一套完整的测试 SDK
可以在开发 Pipeline 的同时，能够实现对一个 Transform 逻辑的单元测试
也可以对整个 Pipeline 的 End-to-End 测试


在 Beam 所支持的各种 Runners 中，有一个 DirectRunner
DirectRunner 即本地机器，整个 Pipeline 会放在本地机器上运行


DoFnTester - 让用户传入一个自定义函数来进行测试 - UDF - User Defined Function
DoFnTester 接收的对象是用户继承实现的 DoFn


不应该将 DoFn 当成一个单 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/09/29/bigdata-beam-pattern/" title="Beam - Pattern"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-pattern.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Pattern"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/29/bigdata-beam-pattern/" title="Beam - Pattern">Beam - Pattern</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-28T16:06:25.000Z" title="Created 2024-09-29 00:06:25">2024-09-29</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">Copier Pattern
每个数据处理模块的输入都是相同的，并且每个数据处理模块都可以单独并且同步地运行处理




1234567891011121314151617181920212223242526272829303132333435363738394041PCollection&lt;Video&gt; videoDataCollection = ...;//  生成高画质视频PCollection&lt;Video&gt; highResolutionVideoCollection = videoDataCollection.apply(&quot;highResolutionTransform&quot;, ParDo.of(new DoFn&lt;Video, Video&gt;()&#123;  @ProcessElement  public void processElement(ProcessContext c) &#123;    c.output(generateHighResolution(c.element()));  &#125;&#125;));//  生成低画质视频PCo ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/28/bigdata-beam-pipeline-io/" title="Beam - Pipeline IO"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-pipeline-io.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Pipeline IO"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/28/bigdata-beam-pipeline-io/" title="Beam - Pipeline IO">Beam - Pipeline IO</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-27T16:06:25.000Z" title="Created 2024-09-28 00:06:25">2024-09-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">读取数据集
一个输入数据集的读取通常是通过 Read Transform 来完成
Read Transform 从外部源读取数据 - 本地文件、数据库、OSS、MQ
Read Transform 返回一个 PCollection，该 PCollection 可以作为一个输入数据集，应用在各种 Transform 上
Pipeline 没有限制调用 Read Transform 的时机
可以在 Pipeline 最开始的时候调用
也可以在经过 N 个步骤的 Transforms 后再调用它来读取另外的数据集






本地文件

1PCollection&lt;String&gt; inputs = p.apply(TextIO.read().from(filepath));


Beam 支持从多个文件路径中读取数据集，文件名匹配规则与 Linux glob 一样
glob 操作符的匹配规则最终要和所使用的底层文件系统挂钩


从不同的外部源读取同一类型的数据来统一作为输入数据集 - 利用 flatten 操作将数据集合并

12345PCollection&lt;String&gt; input1 = p ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/09/27/bigdata-beam-pipeline/" title="Beam - Pipeline"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-pipeline.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Pipeline"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/27/bigdata-beam-pipeline/" title="Beam - Pipeline">Beam - Pipeline</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-26T16:06:25.000Z" title="Created 2024-09-27 00:06:25">2024-09-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">创建
在 Beam 中，所有的数据处理逻辑都会被抽象成 Pipeline 来运行
Pipeline 是对数据处理逻辑的一个封装
包括一整套流程 - 读取数据集、将数据集转换成想要的结果、输出结果数据集






创建 Pipeline

12PipelineOptions options = PipelineOptionsFactory.create();Pipeline p = Pipeline.create(options);

应用

PCollection 具有不可变性
一个 PCollection 一旦生成，就不能在增加或者删除里面的元素了


在 Beam 中，每次 PCollection 经过一个 Transform 之后，Pipeline 都会创建一个新的 PCollection
新创建的 PCollection 又成为下一个 Transform 的输入
原先的 PCollection 不会有任何改变


对同一个 PCollection 可以应用多种不同的 Transform


处理模型
Pipeline 的底层思想依然是 MapReduce
在分布式环境下，整个 Pipeline 会启 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2024/09/26/bigdata-beam-transform/" title="Beam - Transform"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-transform.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - Transform"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/26/bigdata-beam-transform/" title="Beam - Transform">Beam - Transform</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-25T16:06:25.000Z" title="Created 2024-09-26 00:06:25">2024-09-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">DAG
Transform 是 Beam 中数据处理的最基本单元





Beam 把数据转换抽象成有向图
反直觉 - PCollection 是有向图中的边，而 Transform 是有向图中的节点
区分节点和边的关键是看一个 Transform 是不是有一个多余的输入和输出
每个 Transform 都可能有大于一个的输入 PCollection，也可能输出大于一个的输出 PCollection



Apply
Beam 中的 PCollection 有一个抽象的成员函数 Apply，使用任何一个 Transform 时，都需要调用 Apply

123final_collection = input_collection.apply(Transform1).apply(Transform2).apply(Transform3)


Transform概述
ParDo - Parallel Do - 表达的是很通用的并行处理数据操作
GroupByKey - 把一个 Key&#x2F;Value 的数据集按照 Key 归并


可以用 ParDo 实现 GroupByKey


简单实现 - 放一个全 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2024/09/25/bigdata-beam-pcollection/" title="Beam - PCollection"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://big-data-1253868755.cos.ap-guangzhou.myqcloud.com/bigdata-beam-pcollection.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beam - PCollection"></a></div><div class="recent-post-info"><a class="article-title" href="/2024/09/25/bigdata-beam-pcollection/" title="Beam - PCollection">Beam - PCollection</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2024-09-24T16:06:25.000Z" title="Created 2024-09-25 00:06:25">2024-09-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/big-data/">Big Data</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/big-data/beam/">Beam</a></span></div><div class="content">数据抽象
Spark RDD


不同的技术系统有不同的数据结构， 如在 C++  中有 vector、unordered_map
几乎所有的 Beam 数据都能表达为 PCollection
PCollection - Parallel Collection - 可并行计算的数据集，与 Spark RDD 非常类似
在一个分布式计算系统中，需要为用户隐藏实现细节，包括数据是怎样表达和存储的
数据可能来自于内存的数据，也可能来自于外部文件，或者来自于 MySQL 数据库
如果没有一个统一的数据抽象的话，开发者需要不停地修改代码，无法专注于业务逻辑





Coder
将数据类型进行序列化和反序列化，便于在网络上传输


需要为 PCollection 的元素编写 Coder
Coder 的作用与 Beam 的本质紧密相关
计算流程最终会运行在一个分布式系统
所有的数据都可能在网络上的计算机之间相互传递
Coder 就是告诉 Beam 如何将数据类型进行序列化和反序列化，以便于在网络上传输


Coder 需要注册进全局的 CoderRegistry
为自定义的数据类型建立与 Coder 的对应关系，无需每次 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/64/#content-inner">64</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">zhongmingmao</div><div class="author-info__description">Focus on Infrastructure.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">634</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">189</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">80</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Things are always unexpected!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/16/new-java-feature-foreign-memory-api/" title="New Java Feature - Foreign Memory API"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/Java-Foreign-Function-and-Memory-API.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Foreign Memory API"/></a><div class="content"><a class="title" href="/2025/01/16/new-java-feature-foreign-memory-api/" title="New Java Feature - Foreign Memory API">New Java Feature - Foreign Memory API</a><time datetime="2025-01-15T16:06:25.000Z" title="Created 2025-01-16 00:06:25">2025-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/15/new-java-feature-flow/" title="New Java Feature - Flow"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/java-flow.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Flow"/></a><div class="content"><a class="title" href="/2025/01/15/new-java-feature-flow/" title="New Java Feature - Flow">New Java Feature - Flow</a><time datetime="2025-01-14T16:06:25.000Z" title="Created 2025-01-15 00:06:25">2025-01-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/14/new-java-feature-error-code/" title="New Java Feature - Error Code"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/java-exception-recovery.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Error Code"/></a><div class="content"><a class="title" href="/2025/01/14/new-java-feature-error-code/" title="New Java Feature - Error Code">New Java Feature - Error Code</a><time datetime="2025-01-13T16:06:25.000Z" title="Created 2025-01-14 00:06:25">2025-01-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/13/new-java-feature-exception/" title="New Java Feature - Exception"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/java-feature-exception.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Exception"/></a><div class="content"><a class="title" href="/2025/01/13/new-java-feature-exception/" title="New Java Feature - Exception">New Java Feature - Exception</a><time datetime="2025-01-12T16:06:25.000Z" title="Created 2025-01-13 00:06:25">2025-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/12/new-java-feature-switch-matching/" title="New Java Feature - Switch Matching"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/image-20250804150004058.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="New Java Feature - Switch Matching"/></a><div class="content"><a class="title" href="/2025/01/12/new-java-feature-switch-matching/" title="New Java Feature - Switch Matching">New Java Feature - Switch Matching</a><time datetime="2025-01-11T16:06:25.000Z" title="Created 2025-01-12 00:06:25">2025-01-12</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/"><span class="card-category-list-name">AI</span><span class="card-category-list-count">34</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/llm/"><span class="card-category-list-name">LLM</span><span class="card-category-list-count">16</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/rag/"><span class="card-category-list-name">RAG</span><span class="card-category-list-count">18</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/"><span class="card-category-list-name">Big Data</span><span class="card-category-list-count">26</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/beam/"><span class="card-category-list-name">Beam</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/spark/"><span class="card-category-list-name">Spark</span><span class="card-category-list-count">6</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/career/"><span class="card-category-list-name">Career</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-computing/"><span class="card-category-list-name">Cloud Computing</span><span class="card-category-list-count">10</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/big-data/" style="font-size: 1.31em; color: rgb(94, 166, 36)">Big Data</a><a href="/tags/beam/" style="font-size: 1.24em; color: rgb(90, 123, 40)">Beam</a><a href="/tags/spark/" style="font-size: 1.2em; color: rgb(29, 50, 161)">Spark</a><a href="/tags/flink/" style="font-size: 1.15em; color: rgb(3, 192, 175)">Flink</a><a href="/tags/rdd/" style="font-size: 1.15em; color: rgb(156, 126, 198)">RDD</a><a href="/tags/mapreduce/" style="font-size: 1.15em; color: rgb(45, 44, 12)">MapReduce</a><a href="/tags/cloud-computing/" style="font-size: 1.22em; color: rgb(96, 134, 40)">Cloud Computing</a><a href="/tags/iaas/" style="font-size: 1.19em; color: rgb(36, 21, 131)">IaaS</a><a href="/tags/paas/" style="font-size: 1.19em; color: rgb(168, 43, 89)">PaaS</a><a href="/tags/cloud-native/" style="font-size: 1.45em; color: rgb(66, 57, 171)">Cloud Native</a><a href="/tags/kubernetes/" style="font-size: 1.43em; color: rgb(119, 133, 85)">Kubernetes</a><a href="/tags/devops/" style="font-size: 1.18em; color: rgb(107, 100, 49)">DevOps</a><a href="/tags/container/" style="font-size: 1.26em; color: rgb(118, 85, 177)">Container</a><a href="/tags/docker/" style="font-size: 1.28em; color: rgb(190, 164, 172)">Docker</a><a href="/tags/go-core/" style="font-size: 1.17em; color: rgb(29, 146, 23)">Go Core</a><a href="/tags/go/" style="font-size: 1.42em; color: rgb(21, 46, 199)">Go</a><a href="/tags/cloud-native-foundation/" style="font-size: 1.32em; color: rgb(110, 185, 75)">Cloud Native Foundation</a><a href="/tags/infrastructure/" style="font-size: 1.3em; color: rgb(126, 112, 168)">Infrastructure</a><a href="/tags/architecture/" style="font-size: 1.31em; color: rgb(48, 137, 107)">Architecture</a><a href="/tags/iac/" style="font-size: 1.15em; color: rgb(154, 116, 75)">IaC</a><a href="/tags/terraform/" style="font-size: 1.15em; color: rgb(33, 112, 199)">Terraform</a><a href="/tags/crossplane/" style="font-size: 1.15em; color: rgb(67, 193, 142)">Crossplane</a><a href="/tags/pulumi/" style="font-size: 1.15em; color: rgb(180, 108, 120)">Pulumi</a><a href="/tags/argo-cd/" style="font-size: 1.15em; color: rgb(192, 37, 40)">Argo CD</a><a href="/tags/vpc/" style="font-size: 1.15em; color: rgb(26, 149, 114)">VPC</a><a href="/tags/go-engineering/" style="font-size: 1.33em; color: rgb(148, 143, 120)">Go Engineering</a><a href="/tags/swagger/" style="font-size: 1.15em; color: rgb(10, 177, 112)">Swagger</a><a href="/tags/helm/" style="font-size: 1.15em; color: rgb(112, 191, 146)">Helm</a><a href="/tags/runc/" style="font-size: 1.15em; color: rgb(192, 79, 108)">runc</a><a href="/tags/kustomize/" style="font-size: 1.15em; color: rgb(189, 20, 171)">Kustomize</a><a href="/tags/oci/" style="font-size: 1.15em; color: rgb(116, 51, 148)">OCI</a><a href="/tags/buildkit/" style="font-size: 1.15em; color: rgb(176, 151, 64)">BuildKit</a><a href="/tags/crane/" style="font-size: 1.15em; color: rgb(45, 152, 189)">crane</a><a href="/tags/oci-image/" style="font-size: 1.15em; color: rgb(151, 112, 12)">OCI Image</a><a href="/tags/oci-runtime/" style="font-size: 1.15em; color: rgb(54, 68, 83)">OCI Runtime</a><a href="/tags/linux-namespace/" style="font-size: 1.15em; color: rgb(128, 182, 64)">Linux Namespace</a><a href="/tags/linux-cgroup/" style="font-size: 1.15em; color: rgb(127, 93, 176)">Linux CGroup</a><a href="/tags/k8s-manifest/" style="font-size: 1.15em; color: rgb(160, 140, 68)">K8S Manifest</a><a href="/tags/ci/" style="font-size: 1.15em; color: rgb(31, 104, 10)">CI</a><a href="/tags/makefile/" style="font-size: 1.15em; color: rgb(44, 158, 97)">Makefile</a><a href="/tags/rpc/" style="font-size: 1.16em; color: rgb(45, 173, 156)">RPC</a><a href="/tags/grpc/" style="font-size: 1.16em; color: rgb(126, 97, 130)">gRPC</a><a href="/tags/network/" style="font-size: 1.16em; color: rgb(80, 181, 0)">Network</a><a href="/tags/dockerfile/" style="font-size: 1.17em; color: rgb(1, 3, 125)">Dockerfile</a><a href="/tags/linux/" style="font-size: 1.27em; color: rgb(99, 111, 84)">Linux</a><a href="/tags/service-mesh/" style="font-size: 1.18em; color: rgb(14, 169, 182)">Service Mesh</a><a href="/tags/istio/" style="font-size: 1.17em; color: rgb(53, 33, 113)">Istio</a><a href="/tags/etcd/" style="font-size: 1.15em; color: rgb(163, 195, 133)">etcd</a><a href="/tags/raft/" style="font-size: 1.15em; color: rgb(169, 200, 35)">raft</a><a href="/tags/microservices/" style="font-size: 1.27em; color: rgb(169, 73, 85)">Microservices</a><a href="/tags/spring-cloud/" style="font-size: 1.2em; color: rgb(154, 72, 144)">Spring Cloud</a><a href="/tags/spring/" style="font-size: 1.23em; color: rgb(167, 177, 38)">Spring</a><a href="/tags/java/" style="font-size: 1.44em; color: rgb(73, 152, 95)">Java</a><a href="/tags/service-governance/" style="font-size: 1.17em; color: rgb(105, 122, 198)">Service Governance</a><a href="/tags/opa/" style="font-size: 1.2em; color: rgb(30, 152, 75)">OPA</a><a href="/tags/alibaba/" style="font-size: 1.21em; color: rgb(157, 54, 190)">Alibaba</a><a href="/tags/api-gateway/" style="font-size: 1.15em; color: rgb(12, 7, 59)">API Gateway</a><a href="/tags/apisix/" style="font-size: 1.15em; color: rgb(182, 56, 70)">APISIX</a><a href="/tags/observability/" style="font-size: 1.21em; color: rgb(161, 102, 166)">Observability</a><a href="/tags/opentelemetry/" style="font-size: 1.19em; color: rgb(169, 117, 185)">OpenTelemetry</a><a href="/tags/security/" style="font-size: 1.26em; color: rgb(54, 155, 14)">Security</a><a href="/tags/compliance/" style="font-size: 1.17em; color: rgb(169, 107, 120)">Compliance</a><a href="/tags/serverless/" style="font-size: 1.21em; color: rgb(97, 20, 10)">Serverless</a><a href="/tags/faas/" style="font-size: 1.21em; color: rgb(21, 39, 146)">FaaS</a><a href="/tags/computer-basics/" style="font-size: 1.35em; color: rgb(198, 44, 54)">Computer Basics</a><a href="/tags/computer-organization/" style="font-size: 1.35em; color: rgb(74, 9, 176)">Computer Organization</a><a href="/tags/knowledge-map/" style="font-size: 1.15em; color: rgb(149, 101, 126)">Knowledge Map</a><a href="/tags/ebpf/" style="font-size: 1.16em; color: rgb(189, 108, 135)">eBPF</a><a href="/tags/tool/" style="font-size: 1.22em; color: rgb(87, 44, 126)">Tool</a><a href="/tags/git/" style="font-size: 1.22em; color: rgb(145, 133, 140)">Git</a><a href="/tags/concurrency/" style="font-size: 1.15em; color: rgb(146, 110, 30)">Concurrency</a><a href="/tags/cloud/" style="font-size: 1.36em; color: rgb(58, 195, 190)">Cloud</a><a href="/tags/native/" style="font-size: 1.36em; color: rgb(176, 100, 28)">Native</a><a href="/tags/oauth-2-0/" style="font-size: 1.2em; color: rgb(106, 189, 8)">OAuth 2.0</a><a href="/tags/authentication/" style="font-size: 1.17em; color: rgb(143, 190, 81)">Authentication</a><a href="/tags/ldap/" style="font-size: 1.15em; color: rgb(47, 96, 126)">LDAP</a><a href="/tags/jwt/" style="font-size: 1.15em; color: rgb(169, 68, 9)">JWT</a><a href="/tags/storage/" style="font-size: 1.4em; color: rgb(72, 24, 95)">Storage</a><a href="/tags/mysql/" style="font-size: 1.41em; color: rgb(134, 148, 186)">MySQL</a><a href="/tags/innodb/" style="font-size: 1.2em; color: rgb(79, 73, 107)">InnoDB</a><a href="/tags/java-concurrent/" style="font-size: 1.38em; color: rgb(12, 170, 131)">Java Concurrent</a><a href="/tags/actor/" style="font-size: 1.15em; color: rgb(39, 124, 168)">Actor</a><a href="/tags/akka/" style="font-size: 1.15em; color: rgb(128, 172, 174)">Akka</a><a href="/tags/coroutine/" style="font-size: 1.16em; color: rgb(134, 186, 110)">Coroutine</a><a href="/tags/csp/" style="font-size: 1.15em; color: rgb(34, 102, 181)">CSP</a><a href="/tags/disruptor/" style="font-size: 1.15em; color: rgb(89, 176, 192)">Disruptor</a><a href="/tags/netty/" style="font-size: 1.15em; color: rgb(116, 125, 125)">Netty</a><a href="/tags/stm/" style="font-size: 1.15em; color: rgb(173, 75, 45)">STM</a><a href="/tags/mvcc/" style="font-size: 1.15em; color: rgb(183, 128, 113)">MVCC</a><a href="/tags/java-core/" style="font-size: 1.2em; color: rgb(0, 193, 46)">Java Core</a><a href="/tags/java-feature/" style="font-size: 1.28em; color: rgb(100, 7, 92)">Java Feature</a><a href="/tags/java-performance/" style="font-size: 1.33em; color: rgb(121, 171, 115)">Java Performance</a><a href="/tags/cas/" style="font-size: 1.15em; color: rgb(198, 63, 179)">CAS</a><a href="/tags/hashtable/" style="font-size: 1.15em; color: rgb(73, 151, 27)">HashTable</a><a href="/tags/concurrenthashmap/" style="font-size: 1.15em; color: rgb(161, 120, 63)">ConcurrentHashMap</a><a href="/tags/concurrentskiplistmap/" style="font-size: 1.15em; color: rgb(47, 186, 109)">ConcurrentSkipListMap</a><a href="/tags/design-pattern/" style="font-size: 1.18em; color: rgb(100, 38, 115)">Design Pattern</a><a href="/tags/consistency/" style="font-size: 1.15em; color: rgb(77, 138, 56)">Consistency</a><a href="/tags/jvm/" style="font-size: 1.37em; color: rgb(155, 34, 135)">JVM</a><a href="/tags/gc/" style="font-size: 1.16em; color: rgb(190, 140, 116)">GC</a><a href="/tags/hashmap/" style="font-size: 1.15em; color: rgb(43, 155, 31)">HashMap</a><a href="/tags/io/" style="font-size: 1.15em; color: rgb(98, 89, 33)">IO</a><a href="/tags/nio/" style="font-size: 1.16em; color: rgb(47, 165, 67)">NIO</a><a href="/tags/aio/" style="font-size: 1.16em; color: rgb(84, 108, 3)">AIO</a><a href="/tags/epoll/" style="font-size: 1.16em; color: rgb(119, 24, 142)">Epoll</a><a href="/tags/jit/" style="font-size: 1.15em; color: rgb(72, 9, 114)">JIT</a><a href="/tags/synchronized/" style="font-size: 1.16em; color: rgb(110, 21, 118)">synchronized</a><a href="/tags/lock/" style="font-size: 1.15em; color: rgb(177, 134, 63)">Lock</a><a href="/tags/reentrantreadwritelock/" style="font-size: 1.15em; color: rgb(65, 127, 173)">ReentrantReadWriteLock</a><a href="/tags/stampedlock/" style="font-size: 1.15em; color: rgb(161, 55, 65)">StampedLock</a><a href="/tags/bio/" style="font-size: 1.15em; color: rgb(165, 164, 123)">BIO</a><a href="/tags/tomcat/" style="font-size: 1.15em; color: rgb(158, 175, 182)">Tomcat</a><a href="/tags/select/" style="font-size: 1.15em; color: rgb(25, 124, 48)">Select</a><a href="/tags/poll/" style="font-size: 1.15em; color: rgb(105, 65, 103)">Poll</a><a href="/tags/zero-copy/" style="font-size: 1.15em; color: rgb(151, 72, 89)">Zero Copy</a><a href="/tags/mmap/" style="font-size: 1.15em; color: rgb(15, 102, 190)">mmap</a><a href="/tags/reactor/" style="font-size: 1.15em; color: rgb(168, 122, 127)">Reactor</a><a href="/tags/serialization/" style="font-size: 1.15em; color: rgb(185, 174, 77)">Serialization</a><a href="/tags/protobuf/" style="font-size: 1.15em; color: rgb(165, 173, 91)">ProtoBuf</a><a href="/tags/java-stream/" style="font-size: 1.15em; color: rgb(186, 165, 83)">Java Stream</a><a href="/tags/context-switch/" style="font-size: 1.15em; color: rgb(31, 69, 105)">Context Switch</a><a href="/tags/mark-word/" style="font-size: 1.15em; color: rgb(61, 128, 146)">Mark Word</a><a href="/tags/monitor/" style="font-size: 1.15em; color: rgb(13, 164, 45)">Monitor</a><a href="/tags/thread-pool/" style="font-size: 1.15em; color: rgb(58, 68, 154)">Thread Pool</a><a href="/tags/lambda/" style="font-size: 1.15em; color: rgb(166, 76, 42)">Lambda</a><a href="/tags/bytecode-manipulation/" style="font-size: 1.17em; color: rgb(125, 187, 96)">Bytecode Manipulation</a><a href="/tags/asm/" style="font-size: 1.15em; color: rgb(161, 196, 133)">ASM</a><a href="/tags/jol/" style="font-size: 1.17em; color: rgb(162, 138, 180)">JOL</a><a href="/tags/middleware/" style="font-size: 1.39em; color: rgb(89, 43, 143)">Middleware</a><a href="/tags/mq/" style="font-size: 1.4em; color: rgb(3, 162, 89)">MQ</a><a href="/tags/kafka/" style="font-size: 1.39em; color: rgb(191, 94, 190)">Kafka</a><a href="/tags/stream/" style="font-size: 1.39em; color: rgb(119, 66, 95)">Stream</a><a href="/tags/rebalance/" style="font-size: 1.17em; color: rgb(156, 110, 170)">Rebalance</a><a href="/tags/avro/" style="font-size: 1.18em; color: rgb(97, 144, 17)">Avro</a><a href="/tags/consumer-group/" style="font-size: 1.15em; color: rgb(126, 193, 34)">Consumer Group</a><a href="/tags/compression/" style="font-size: 1.15em; color: rgb(182, 87, 124)">Compression</a><a href="/tags/tcp/" style="font-size: 1.16em; color: rgb(20, 65, 80)">TCP</a><a href="/tags/idempotence/" style="font-size: 1.15em; color: rgb(196, 145, 184)">Idempotence</a><a href="/tags/producer/" style="font-size: 1.15em; color: rgb(51, 21, 101)">Producer</a><a href="/tags/load-balance/" style="font-size: 1.15em; color: rgb(61, 11, 55)">Load Balance</a><a href="/tags/distributed-design-pattern/" style="font-size: 1.17em; color: rgb(2, 129, 35)">Distributed Design Pattern</a><a href="/tags/distributed-architecture/" style="font-size: 1.15em; color: rgb(171, 167, 87)">Distributed Architecture</a><a href="/tags/career/" style="font-size: 1.15em; color: rgb(70, 145, 42)">Career</a><a href="/tags/linux-performance/" style="font-size: 1.17em; color: rgb(14, 27, 153)">Linux Performance</a><a href="/tags/linux-practice/" style="font-size: 1.24em; color: rgb(38, 116, 21)">Linux Practice</a><a href="/tags/ext4/" style="font-size: 1.15em; color: rgb(34, 99, 108)">ext4</a><a href="/tags/file-system/" style="font-size: 1.15em; color: rgb(194, 112, 18)">File System</a><a href="/tags/ai/" style="font-size: 1.34em; color: rgb(92, 120, 13)">AI</a><a href="/tags/llm/" style="font-size: 1.34em; color: rgb(184, 182, 18)">LLM</a><a href="/tags/chatgpt/" style="font-size: 1.15em; color: rgb(47, 68, 33)">ChatGPT</a><a href="/tags/nlp/" style="font-size: 1.25em; color: rgb(55, 88, 64)">NLP</a><a href="/tags/python/" style="font-size: 1.3em; color: rgb(86, 110, 160)">Python</a><a href="/tags/fastapi/" style="font-size: 1.15em; color: rgb(136, 127, 152)">FastAPI</a><a href="/tags/uvicorn/" style="font-size: 1.15em; color: rgb(152, 31, 32)">Uvicorn</a><a href="/tags/transformer/" style="font-size: 1.16em; color: rgb(4, 135, 176)">Transformer</a><a href="/tags/machine-learning/" style="font-size: 1.17em; color: rgb(73, 123, 108)">Machine Learning</a><a href="/tags/svm/" style="font-size: 1.15em; color: rgb(200, 198, 165)">SVM</a><a href="/tags/rnn/" style="font-size: 1.15em; color: rgb(193, 98, 48)">RNN</a><a href="/tags/seq2seq/" style="font-size: 1.16em; color: rgb(11, 70, 82)">Seq2Seq</a><a href="/tags/attention/" style="font-size: 1.15em; color: rgb(152, 85, 148)">Attention</a><a href="/tags/langchain/" style="font-size: 1.19em; color: rgb(147, 119, 1)">LangChain</a><a href="/tags/ai-agent/" style="font-size: 1.18em; color: rgb(5, 123, 33)">AI Agent</a><a href="/tags/rag/" style="font-size: 1.29em; color: rgb(63, 142, 177)">RAG</a><a href="/tags/lora/" style="font-size: 1.15em; color: rgb(199, 146, 181)">LoRA</a><a href="/tags/peft/" style="font-size: 1.15em; color: rgb(108, 129, 66)">PEFT</a><a href="/tags/word2vec/" style="font-size: 1.15em; color: rgb(11, 167, 194)">Word2Vec</a><a href="/tags/math/" style="font-size: 1.16em; color: rgb(124, 135, 164)">Math</a><a href="/tags/faiss/" style="font-size: 1.15em; color: rgb(9, 14, 57)">Faiss</a><a href="/tags/microservices-governance/" style="font-size: 1.21em; color: rgb(92, 190, 86)">Microservices Governance</a><a href="/tags/config/" style="font-size: 1.17em; color: rgb(96, 60, 146)">Config</a><a href="/tags/configuration-center/" style="font-size: 1.17em; color: rgb(94, 59, 186)">Configuration Center</a><a href="/tags/apollo/" style="font-size: 1.17em; color: rgb(74, 151, 160)">Apollo</a><a href="/tags/oauth2/" style="font-size: 1.2em; color: rgb(58, 74, 90)">Oauth2</a><a href="/tags/spring-security/" style="font-size: 1.19em; color: rgb(55, 69, 48)">Spring Security</a><a href="/tags/spring-security-oauth2/" style="font-size: 1.19em; color: rgb(46, 48, 50)">Spring Security OAuth2</a><a href="/tags/performance-tuning/" style="font-size: 1.15em; color: rgb(34, 115, 147)">Performance Tuning</a><a href="/tags/chatops/" style="font-size: 1.15em; color: rgb(144, 183, 124)">ChatOps</a><a href="/tags/chatbot/" style="font-size: 1.15em; color: rgb(115, 32, 21)">Chatbot</a><a href="/tags/graphrag/" style="font-size: 1.15em; color: rgb(99, 144, 76)">GraphRAG</a><a href="/tags/rerank/" style="font-size: 1.15em; color: rgb(80, 198, 191)">Rerank</a><a href="/tags/kg-rag/" style="font-size: 1.15em; color: rgb(3, 185, 106)">KG-RAG</a><a href="/tags/prompting/" style="font-size: 1.15em; color: rgb(84, 164, 119)">Prompting</a><a href="/tags/vector/" style="font-size: 1.16em; color: rgb(89, 146, 145)">Vector</a><a href="/tags/vim/" style="font-size: 1.2em; color: rgb(103, 113, 81)">Vim</a><a href="/tags/web/" style="font-size: 1.2em; color: rgb(94, 172, 54)">Web</a><a href="/tags/javascript/" style="font-size: 1.19em; color: rgb(148, 186, 78)">JavaScript</a><a href="/tags/zookeeper/" style="font-size: 1.16em; color: rgb(116, 123, 15)">Zookeeper</a><a href="/tags/distributed-lock/" style="font-size: 1.15em; color: rgb(152, 160, 87)">Distributed Lock</a><a href="/tags/zab/" style="font-size: 1.15em; color: rgb(176, 6, 14)">ZAB</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">January 2025</span><span class="card-archive-list-count">16</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><span class="card-archive-list-count">18</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><span class="card-archive-list-count">30</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><span class="card-archive-list-count">31</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">June 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">May 2023</span><span class="card-archive-list-count">11</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">April 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">634</div></div><div class="webinfo-item"><div class="item-name">Run time :</div><div class="item-count" id="runtimeshow" data-publishDate="2015-06-30T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">1211.6k</div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-08-09T12:58:12.845Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.pixabay.com/photo/2018/08/27/15/17/fishing-3635221_1280.png')"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2025 By zhongmingmao</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Life is like a box of chocolates. You can't know what you'll eat until you open it.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["Stay hungry, stay foolish."])
  } else {
    document.getElementById("subtitle").innerHTML = 'Stay hungry, stay foolish.'
  }
}
typedJSFn.run(subtitleType)</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>