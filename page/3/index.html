<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>ByteCoding</title><meta name="author" content="zhongmingmao"><meta name="copyright" content="zhongmingmao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Focus on Infrastructure">
<meta property="og:type" content="website">
<meta property="og:title" content="ByteCoding">
<meta property="og:url" content="https://blog.zhongmingmao.top/page/3/index.html">
<meta property="og:site_name" content="ByteCoding">
<meta property="og:description" content="Focus on Infrastructure">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png">
<meta property="article:author" content="zhongmingmao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="shortcut icon" href="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="canonical" href="https://blog.zhongmingmao.top/page/3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":512,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":256},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":32,"languages":{"author":"Author: zhongmingmao","link":"Link: ","source":"Source: ByteCoding","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ByteCoding',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-11-09 09:18:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ByteCoding" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">459</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">125</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">65</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2022/10/16/13/53/early-morning-7525151_1280.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="ByteCoding"><span class="site-name">ByteCoding</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">ByteCoding</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/12/cloud-native-foundation-k8s-service-discovery/" title="Kubernetes - Service Discovery"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/kubernetes-service-discovery.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - Service Discovery"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/12/cloud-native-foundation-k8s-service-discovery/" title="Kubernetes - Service Discovery">Kubernetes - Service Discovery</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-11T16:06:25.000Z" title="Created 2022-12-12 00:06:25">2022-12-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">基本概念发展历程


数据包
负载均衡的核心原理 - 修改包头数据



通过浏览器访问某网站的过程（组包在应用层，传包在内核层）


在浏览器输入网站的网址
浏览器本质上是一个 HTTP 客户端，组装成 HTTP 包


做 DNS 解析（递归）
封装 TCP 包（源端口 + 目标端口）
封装 IP 包（源 IP + 目标 IP - 来自于 DNS）

负载均衡
面向连接的负载均衡不一定能保证平均，如 grpc 是基于 http&#x2F;2，会复用 TCP 连接，L4 的负载均衡就无法实现平均

方案集中式
F5（HLB） &#x2F; Nginx（SLB） - 接入集群外部流量



在服务消费者和服务提供者之间有一个独立的 LB
LB 上有所有服务的地址映射表，通常由运维配置注册
当服务消费者调用某个目标服务时，向 LB 发起请求，由 LB 以某种策略做负载均衡后将请求转发到目标服务
LB 一般具备健康检查的能力，能自动摘除不健康的服务实例
服务消费者通过 DNS 发现 LB，运维人员配置一个指向该 LB 的 DNS 域名
优缺点
优点
方案简单，在 LB 上容易实现集中式的访问控制，为业界主流


 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/11/go-foundation-design-philosophy/" title="Go - Design Philosophy"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/go-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Design Philosophy"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/11/go-foundation-design-philosophy/" title="Go - Design Philosophy">Go - Design Philosophy</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-10T16:06:25.000Z" title="Created 2022-12-11 00:06:25">2022-12-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/go/">Go</a></span></div><div class="content">简单
语言特性始终保持少且足够的水平，不走语言融合的道路，简单的设计哲学是 Go 生产力的源泉


仅有 25 个关键字，主流编程语言最少
内置 GC，降低开发人员内存管理的心智负担
首字母大小写决定可见性，无需通过额外关键字修饰
变量初始为类型零值，避免以随机值作为初值的问题
内置数组边界检查，极大减少越界访问带来的安全隐患
内置并发支持，简化并发程序设计
内置接口类型，为组合的设计哲学奠定基础
原生提供完善的工具链，开箱即用



显式
Go - 程序员应该明确知道在做什么；C - 信任程序员


Go 不允许不同类型的变量进行混合计算，也不会进行隐式自动转换
Go 采用基于值比较的错误处理方案
函数或方法的错误会通过 return 语句显式地返回，并且调用者通常不能忽略对返回的错误的处理



组合
组合是构建 Go 程序骨架的主要方式，可以大幅度降低程序元素间的耦合，提高程序的可扩展性和灵活性


在 Go 中，找不到经典的 OOP 语法元素、类型体系和继承机制，Go 推崇的是组合的设计哲学
提供正交的语法元素，以供后续组合使用
包之间相对独立，没有子包的概念
没有类型层次体系，各类型之间互相独立，没 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/10/cloud-native-foundation-k8s-pod-life-cycle/" title="Kubernetes - Pod Life Cycle"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/pod-life-cycle.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - Pod Life Cycle"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/10/cloud-native-foundation-k8s-pod-life-cycle/" title="Kubernetes - Pod Life Cycle">Kubernetes - Pod Life Cycle</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-09T16:06:25.000Z" title="Created 2022-12-10 00:06:25">2022-12-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">生命周期
Pending - 调度尚未成功，ContainerCreating - 完成调度




Pod 状态机
Pod Phase
Pod Phase: Pending &#x2F; Running &#x2F; Succeeded &#x2F; Failed &#x2F; Unknown


k get pod 显示的 STATUS 是由 pod.status.phase 和 pod.status.conditions 计算得出

123$ k get po nginxNAME    READY   STATUS    RESTARTS   AGEnginx   1/1     Running   0          35s


k get po nginx -oyaml

12345678910111213141516171819202122232425262728293031status:  conditions:  - lastProbeTime: null    lastTransitionTime: &quot;2022-08-28T07:00:45Z&quot;    status: & ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/09/cloud-native-foundation-k8s-csi/" title="Kubernetes - CSI"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/k8s-csi.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - CSI"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/09/cloud-native-foundation-k8s-csi/" title="Kubernetes - CSI">Kubernetes - CSI</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-08T16:06:25.000Z" title="Created 2022-12-09 00:06:25">2022-12-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">运行时存储
运行时存储：镜像只读层 + 容器读写层（写性能不高）



容器启动后，运行时所需文件系统的性能直接影响容器性能
早期 Docker 使用 DeviceMapper 作为容器运行时的存储驱动，因为 OverlayFS 尚未合并进 Linux Kernel
目前 Docker 和 containerd 都默认以 OverlayFS 作为运行时存储驱动
OverlayFS 的性能很好，与操作主机文件的性能几乎一致，比 DeviceMapper 优 20%



CSI分类
以插件的形式来实现对不同存储的支持和扩展




Plugin
Desc



in-tree
代码耦合在 Kubernetes 中，社区不再接受新的 in-tree 存储插件


out-of-tree - FlexVolume - Native Call
Kubernetes 通过调用 Node 的本地可执行文件与存储插件进行交互FlexVolume 插件需要 Node 用 root 权限安装插件驱动执行模式跟 CNI 非常类似


out-of-tree - CSI - RPC
CSI 通过 RPC 与存储驱动进行交互


插 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/08/cloud-native-foundation-k8s-cni-v2/" title="Kubernetes - CNI"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/cni-logo-card.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - CNI"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/08/cloud-native-foundation-k8s-cni-v2/" title="Kubernetes - CNI">Kubernetes - CNI</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-07T16:06:25.000Z" title="Created 2022-12-08 00:06:25">2022-12-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">网络分类


Type
Desc



CNI
Pod 到 Pod 的网络，Node 到 Pod 的网络


kube-proxy
通过 Service 访问


Ingress
入站流量




基础原则
所有 Pod 能够不通过 NAT 就能互相访问
所有 Node 能够不通过 NAT 就能互相访问
容器内看到的 IP 地址和外部组件看到的容器 IP 是一样的


补充说明


在 Kubernetes 集群，IP 地址是以 Pod 为单位进行分配的，每个 Pod 拥有一个独立的 IP 地址
一个 Pod 内部的所有容器共享一个网络栈，即宿主上的一个 Network Namespace
Pod 内的所有容器能够通过 localhost:port 来连接对方
在 Kubernetes 中，提供一个轻量的通用容器网络接口 CNI
Container Network Interface，用来设置和删除容器的网络连通性


Container Runtime 通过 CNI 调用网络插件来完成容器的网络设置

插件分类
下面的 Plugin 均由 ContainerNetworking 组维护


IPAM -&g ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/07/cloud-native-foundation-k8s-cri/" title="Kubernetes - CRI"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/kubernetes-trends_k8s_container_runtime_popularity.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - CRI"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/07/cloud-native-foundation-k8s-cri/" title="Kubernetes - CRI">Kubernetes - CRI</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-06T16:06:25.000Z" title="Created 2022-12-07 00:06:25">2022-12-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">概述
Container Runtime 位于 Node 上，负责容器的整个生命周期，其中 Docker 应用最为广泛





CRI 是 Kubernetes 定义的一组 gRPC 服务



Dockershim 支持 CRI，代码耦合在 kubelet 中
而 Docker 本身是不支持 CRI 的，但 Docker 内部的 containerd 是支持 CRI 的




Kubelet 作为客户端，基于 gRPC 框架，通过 Socket 和 Container Runtime 通信
Container Runtime 提供 gRPC 服务
Image Service - 下载、检查和删除镜像
Runtime Service - 容器生命周期管理 + 与容器交互
区分了 SandBox + Container






Push Image 并不在 CRI 中 – 开发环境用 Docker，生产环境用 containerd



运行时分层




Runtime
Impl



CRI - High-level - gRPC
Dockershim / containerd / CRI-O


 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/06/cloud-native-foundation-k8s-kubelet/" title="Kubernetes - Kubelet"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/kubernetes-architecture.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - Kubelet"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/06/cloud-native-foundation-k8s-kubelet/" title="Kubernetes - Kubelet">Kubernetes - Kubelet</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-05T16:06:25.000Z" title="Created 2022-12-06 00:06:25">2022-12-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">架构
每个 Node 上运行一个 Kubelet 服务进程，默认监听 10250 端口





接收并执行 Master 的指令
管理 Pod 以及 Pod 中的容器
在 API Server 注册 Node 信息，定期向 Master 汇报 Node 的资源使用情况
通过 cAdvisor 监控 Node 和容器的资源
cAdvisor 通过 Cgroups 收集并上报容器的资源用量



Node 管理
Node 自注册 + Node 状态更新


自注册模式：Kubelet 通过启动参数 --register-node 来确定是否向 API Server 注册
Kubelet 没有选择自注册模式
用户需要自己配置 Node 资源信息
告知 Kubelet 集群上的 API Server 的位置


Kubelet 选择自注册模式
Kubelet 定时向 API Server 发送 Node 信息
API Server 在接收到 Node 信息后，转存到 etcd



Pod 管理
syncLoop - Kubelet 本身也是控制器模式


computePodActions - 比对 Pod Ma ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/05/cloud-native-foundation-k8s-controller-manager/" title="Kubernetes - Controller Manager"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/kdpv.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - Controller Manager"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/05/cloud-native-foundation-k8s-controller-manager/" title="Kubernetes - Controller Manager">Kubernetes - Controller Manager</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-04T16:06:25.000Z" title="Created 2022-12-05 00:06:25">2022-12-05</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">工作流程
Informer Framework 和 Lister Framework 可以借助代码生成器生成


Lister 维护了一份 API Server 的缓存数据（减少对 API Server 的访问压力）


Informer 会通过 Indexer 为对象计算一个 Key，然后入队，Worker 会消费队列，并从 Lister 查询缓存数据





核心 Controller
Controller Manager 是 Controller 的集合




Controller
Desc
API



Job Controller
处理 Job



Cronjob Controller
处理 Cronjob



Pod AutoScaler
处理 Pod 的自动扩缩容
HorizontalPodAutoscaler


RelicaSet
依据 RelicaSet Spec 创建 Pod



Service Controller
依据 Service 的 LoadBalancer Type 创建 LB VIP



ServiceAccount Controller
确保 ServiceA ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/04/cloud-native-foundation-k8s-scheduler/" title="Kubernetes - Scheduler"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/rebalancing-8_qgh6ro.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - Scheduler"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/04/cloud-native-foundation-k8s-scheduler/" title="Kubernetes - Scheduler">Kubernetes - Scheduler</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-03T16:06:25.000Z" title="Created 2022-12-04 00:06:25">2022-12-04</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">概述
kube-scheduler 负责分配调度 Pod 到集群内的 Node 上


监听 kube-apiserver，查询还未分配 Node 的 Pod，然后根据调度策略为这些 Pod 分配 Node

123456789$ k get po -n kube-system coredns-7f6cbbb7b8-njp2w -oyamlapiVersion: v1kind: Podmetadata:  ...spec:  ...  nodeName: mac-k8s  ...




阶段




Stage
Desc



predicate
过滤不符合条件的 Node


priority
优先级排序，选择优先级最高的 Node


Predicates
过滤

Strategy


Strategy
Desc



PodFitsHostPorts
检查是否有 Host Ports 冲突


PodFitsPorts
与 PodFitsHostPorts 一致


PodFitsResources
检查 Node 的资源是否充足


HostName
检查候选 Node 与 pod.Spec.Nod ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/03/cloud-native-foundation-k8s-apiserver/" title="Kubernetes - API Server"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cnf-1253868755.cos.ap-guangzhou.myqcloud.com/k8s/Screen-Shot-2022-01-22-at-10.52.54-AM.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kubernetes - API Server"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/03/cloud-native-foundation-k8s-apiserver/" title="Kubernetes - API Server">Kubernetes - API Server</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2022-12-02T16:06:25.000Z" title="Created 2022-12-03 00:06:25">2022-12-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/cloud-native/">Cloud Native</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/">Cloud Native Foundation</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/cloud-native/cloud-native-foundation/kubernetes/">Kubernetes</a></span></div><div class="content">概述
API Server


提供集群管理的 REST API
提供其它模块之间数据交互和通信的枢纽
其它模块通过 API Server 查询或者修改数据，只有 API Server 才能直接操作 etcd






访问控制：认证 + 鉴权 + 准入


Mutating Admission 可以修改对象，而 Validating Admission 不可以修改对象



认证
开启 TLS 时，所有请求都需要首先认证
Kubernetes 支持多种认证机制，并支持同时开启多个认证插件（只需要有 1 个认证通过即可）
如果认证成功，进入鉴权模块，如果认证失败，则返回 401


认证插件


X509 证书
在 API Server 启动时配置 --client-ca-file
CN 域（CommonName）用作用户名，而O 域（Organization）则用作 Group 名


静态 Token 文件
在 API Server 启动时配置 --token-auth-file
采用 csv 格式：token,user,uid,[group...]


引导 Token
目的：为了支持平滑地启动引导新 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/46/#content-inner">46</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">zhongmingmao</div><div class="author-info__description">Focus on Infrastructure.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">459</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">125</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">65</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Things are always unexpected!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/01/go-foundation-struct/" title="Go - Struct"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/go-struct.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Struct"/></a><div class="content"><a class="title" href="/2023/01/01/go-foundation-struct/" title="Go - Struct">Go - Struct</a><time datetime="2022-12-31T16:06:25.000Z" title="Created 2023-01-01 00:06:25">2023-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/31/go-foundation-map/" title="Go - Map"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/gomap.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Map"/></a><div class="content"><a class="title" href="/2022/12/31/go-foundation-map/" title="Go - Map">Go - Map</a><time datetime="2022-12-30T16:06:25.000Z" title="Created 2022-12-31 00:06:25">2022-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/30/go-foundation-array-slice/" title="Go - Array + Slice"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/gophslice.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Array + Slice"/></a><div class="content"><a class="title" href="/2022/12/30/go-foundation-array-slice/" title="Go - Array + Slice">Go - Array + Slice</a><time datetime="2022-12-29T16:06:25.000Z" title="Created 2022-12-30 00:06:25">2022-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/29/go-foundation-constant/" title="Go - Constant"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/go-constant.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Constant"/></a><div class="content"><a class="title" href="/2022/12/29/go-foundation-constant/" title="Go - Constant">Go - Constant</a><time datetime="2022-12-28T16:06:25.000Z" title="Created 2022-12-29 00:06:25">2022-12-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/28/go-foundation-primitive/" title="Go - Primitive Type"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://go-1253868755.cos.ap-guangzhou.myqcloud.com/foundation/gotype.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go - Primitive Type"/></a><div class="content"><a class="title" href="/2022/12/28/go-foundation-primitive/" title="Go - Primitive Type">Go - Primitive Type</a><time datetime="2022-12-27T16:06:25.000Z" title="Created 2022-12-28 00:06:25">2022-12-28</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/career/"><span class="card-category-list-name">Career</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-computing/"><span class="card-category-list-name">Cloud Computing</span><span class="card-category-list-count">10</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-computing/iaas/"><span class="card-category-list-name">IaaS</span><span class="card-category-list-count">5</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-computing/paas/"><span class="card-category-list-name">PaaS</span><span class="card-category-list-count">5</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-native/"><span class="card-category-list-name">Cloud Native</span><span class="card-category-list-count">115</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-native/cloud-native-foundation/"><span class="card-category-list-name">Cloud Native Foundation</span><span class="card-category-list-count">89</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-native/cloud-native-foundation/container/"><span class="card-category-list-name">Container</span><span class="card-category-list-count">2</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-native/cloud-native-foundation/container/docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">2</span></a></li></ul></li></ul></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/cloud-computing/" style="font-size: 1.24em; color: rgb(190, 198, 78)">Cloud Computing</a><a href="/tags/iaas/" style="font-size: 1.2em; color: rgb(138, 49, 89)">IaaS</a><a href="/tags/paas/" style="font-size: 1.2em; color: rgb(134, 113, 122)">PaaS</a><a href="/tags/cloud-native/" style="font-size: 1.45em; color: rgb(171, 163, 89)">Cloud Native</a><a href="/tags/go-core/" style="font-size: 1.17em; color: rgb(111, 7, 101)">Go Core</a><a href="/tags/go/" style="font-size: 1.39em; color: rgb(90, 147, 76)">Go</a><a href="/tags/container/" style="font-size: 1.29em; color: rgb(117, 83, 64)">Container</a><a href="/tags/docker/" style="font-size: 1.3em; color: rgb(91, 6, 161)">Docker</a><a href="/tags/go-engineering/" style="font-size: 1.31em; color: rgb(153, 48, 22)">Go Engineering</a><a href="/tags/rpc/" style="font-size: 1.16em; color: rgb(41, 40, 150)">RPC</a><a href="/tags/grpc/" style="font-size: 1.15em; color: rgb(149, 66, 82)">gRPC</a><a href="/tags/network/" style="font-size: 1.16em; color: rgb(152, 31, 50)">Network</a><a href="/tags/kubernetes/" style="font-size: 1.43em; color: rgb(167, 93, 172)">Kubernetes</a><a href="/tags/cloud-native-foundation/" style="font-size: 1.32em; color: rgb(153, 183, 31)">Cloud Native Foundation</a><a href="/tags/linux/" style="font-size: 1.3em; color: rgb(74, 69, 34)">Linux</a><a href="/tags/dockerfile/" style="font-size: 1.17em; color: rgb(197, 135, 37)">Dockerfile</a><a href="/tags/microservices/" style="font-size: 1.3em; color: rgb(45, 115, 178)">Microservices</a><a href="/tags/spring-cloud/" style="font-size: 1.22em; color: rgb(35, 51, 90)">Spring Cloud</a><a href="/tags/spring/" style="font-size: 1.25em; color: rgb(102, 191, 1)">Spring</a><a href="/tags/java/" style="font-size: 1.44em; color: rgb(130, 178, 188)">Java</a><a href="/tags/service-governance/" style="font-size: 1.17em; color: rgb(168, 124, 67)">Service Governance</a><a href="/tags/opa/" style="font-size: 1.22em; color: rgb(148, 181, 40)">OPA</a><a href="/tags/alibaba/" style="font-size: 1.23em; color: rgb(136, 154, 186)">Alibaba</a><a href="/tags/security/" style="font-size: 1.29em; color: rgb(70, 71, 3)">Security</a><a href="/tags/compliance/" style="font-size: 1.17em; color: rgb(62, 93, 109)">Compliance</a><a href="/tags/computer-basics/" style="font-size: 1.35em; color: rgb(148, 22, 31)">Computer Basics</a><a href="/tags/computer-organization/" style="font-size: 1.35em; color: rgb(60, 155, 167)">Computer Organization</a><a href="/tags/knowledge-map/" style="font-size: 1.15em; color: rgb(21, 108, 89)">Knowledge Map</a><a href="/tags/architecture/" style="font-size: 1.29em; color: rgb(152, 190, 147)">Architecture</a><a href="/tags/devops/" style="font-size: 1.15em; color: rgb(85, 120, 124)">DevOps</a><a href="/tags/tool/" style="font-size: 1.24em; color: rgb(94, 173, 31)">Tool</a><a href="/tags/git/" style="font-size: 1.24em; color: rgb(110, 178, 171)">Git</a><a href="/tags/cloud/" style="font-size: 1.2em; color: rgb(26, 158, 64)">Cloud</a><a href="/tags/native/" style="font-size: 1.2em; color: rgb(149, 29, 52)">Native</a><a href="/tags/infrastructure/" style="font-size: 1.28em; color: rgb(2, 89, 147)">Infrastructure</a><a href="/tags/authentication/" style="font-size: 1.17em; color: rgb(169, 44, 9)">Authentication</a><a href="/tags/ldap/" style="font-size: 1.15em; color: rgb(165, 139, 44)">LDAP</a><a href="/tags/oauth-2-0/" style="font-size: 1.22em; color: rgb(34, 123, 77)">OAuth 2.0</a><a href="/tags/storage/" style="font-size: 1.4em; color: rgb(180, 138, 191)">Storage</a><a href="/tags/mysql/" style="font-size: 1.42em; color: rgb(167, 21, 140)">MySQL</a><a href="/tags/innodb/" style="font-size: 1.21em; color: rgb(12, 25, 12)">InnoDB</a><a href="/tags/java-concurrent/" style="font-size: 1.37em; color: rgb(153, 64, 186)">Java Concurrent</a><a href="/tags/actor/" style="font-size: 1.15em; color: rgb(199, 69, 121)">Actor</a><a href="/tags/akka/" style="font-size: 1.15em; color: rgb(31, 200, 200)">Akka</a><a href="/tags/coroutine/" style="font-size: 1.16em; color: rgb(194, 116, 156)">Coroutine</a><a href="/tags/csp/" style="font-size: 1.15em; color: rgb(183, 79, 70)">CSP</a><a href="/tags/disruptor/" style="font-size: 1.15em; color: rgb(129, 128, 142)">Disruptor</a><a href="/tags/netty/" style="font-size: 1.15em; color: rgb(193, 144, 43)">Netty</a><a href="/tags/stm/" style="font-size: 1.15em; color: rgb(7, 68, 199)">STM</a><a href="/tags/mvcc/" style="font-size: 1.15em; color: rgb(66, 160, 82)">MVCC</a><a href="/tags/java-core/" style="font-size: 1.22em; color: rgb(125, 184, 74)">Java Core</a><a href="/tags/java-performance/" style="font-size: 1.33em; color: rgb(158, 86, 65)">Java Performance</a><a href="/tags/cas/" style="font-size: 1.15em; color: rgb(123, 159, 132)">CAS</a><a href="/tags/hashtable/" style="font-size: 1.15em; color: rgb(145, 192, 74)">HashTable</a><a href="/tags/concurrenthashmap/" style="font-size: 1.15em; color: rgb(39, 152, 134)">ConcurrentHashMap</a><a href="/tags/concurrentskiplistmap/" style="font-size: 1.15em; color: rgb(131, 124, 16)">ConcurrentSkipListMap</a><a href="/tags/design-pattern/" style="font-size: 1.18em; color: rgb(104, 161, 106)">Design Pattern</a><a href="/tags/consistency/" style="font-size: 1.15em; color: rgb(48, 95, 154)">Consistency</a><a href="/tags/jvm/" style="font-size: 1.36em; color: rgb(68, 69, 71)">JVM</a><a href="/tags/gc/" style="font-size: 1.16em; color: rgb(91, 11, 127)">GC</a><a href="/tags/hashmap/" style="font-size: 1.15em; color: rgb(137, 152, 0)">HashMap</a><a href="/tags/io/" style="font-size: 1.15em; color: rgb(150, 12, 139)">IO</a><a href="/tags/nio/" style="font-size: 1.16em; color: rgb(150, 107, 6)">NIO</a><a href="/tags/aio/" style="font-size: 1.16em; color: rgb(46, 130, 159)">AIO</a><a href="/tags/epoll/" style="font-size: 1.16em; color: rgb(1, 21, 17)">Epoll</a><a href="/tags/jit/" style="font-size: 1.15em; color: rgb(182, 170, 104)">JIT</a><a href="/tags/synchronized/" style="font-size: 1.16em; color: rgb(67, 98, 62)">synchronized</a><a href="/tags/lock/" style="font-size: 1.15em; color: rgb(117, 57, 29)">Lock</a><a href="/tags/reentrantreadwritelock/" style="font-size: 1.15em; color: rgb(141, 130, 41)">ReentrantReadWriteLock</a><a href="/tags/stampedlock/" style="font-size: 1.15em; color: rgb(50, 179, 49)">StampedLock</a><a href="/tags/serialization/" style="font-size: 1.15em; color: rgb(164, 144, 13)">Serialization</a><a href="/tags/protobuf/" style="font-size: 1.15em; color: rgb(88, 146, 126)">ProtoBuf</a><a href="/tags/java-stream/" style="font-size: 1.15em; color: rgb(82, 104, 192)">Java Stream</a><a href="/tags/mark-word/" style="font-size: 1.15em; color: rgb(32, 70, 189)">Mark Word</a><a href="/tags/monitor/" style="font-size: 1.15em; color: rgb(97, 41, 91)">Monitor</a><a href="/tags/context-switch/" style="font-size: 1.15em; color: rgb(120, 189, 124)">Context Switch</a><a href="/tags/thread-pool/" style="font-size: 1.15em; color: rgb(30, 191, 181)">Thread Pool</a><a href="/tags/lambda/" style="font-size: 1.15em; color: rgb(183, 139, 50)">Lambda</a><a href="/tags/bytecode-manipulation/" style="font-size: 1.17em; color: rgb(137, 50, 116)">Bytecode Manipulation</a><a href="/tags/asm/" style="font-size: 1.15em; color: rgb(0, 113, 25)">ASM</a><a href="/tags/jol/" style="font-size: 1.17em; color: rgb(177, 58, 157)">JOL</a><a href="/tags/middleware/" style="font-size: 1.38em; color: rgb(12, 77, 125)">Middleware</a><a href="/tags/mq/" style="font-size: 1.38em; color: rgb(184, 93, 72)">MQ</a><a href="/tags/kafka/" style="font-size: 1.38em; color: rgb(169, 132, 16)">Kafka</a><a href="/tags/stream/" style="font-size: 1.38em; color: rgb(149, 92, 137)">Stream</a><a href="/tags/rebalance/" style="font-size: 1.17em; color: rgb(56, 175, 183)">Rebalance</a><a href="/tags/avro/" style="font-size: 1.18em; color: rgb(63, 182, 80)">Avro</a><a href="/tags/compression/" style="font-size: 1.15em; color: rgb(187, 192, 66)">Compression</a><a href="/tags/consumer-group/" style="font-size: 1.15em; color: rgb(67, 151, 150)">Consumer Group</a><a href="/tags/tcp/" style="font-size: 1.16em; color: rgb(43, 177, 95)">TCP</a><a href="/tags/idempotence/" style="font-size: 1.15em; color: rgb(20, 78, 136)">Idempotence</a><a href="/tags/producer/" style="font-size: 1.15em; color: rgb(85, 171, 67)">Producer</a><a href="/tags/load-balance/" style="font-size: 1.15em; color: rgb(85, 80, 176)">Load Balance</a><a href="/tags/distributed-architecture/" style="font-size: 1.15em; color: rgb(24, 166, 16)">Distributed Architecture</a><a href="/tags/distributed-design-pattern/" style="font-size: 1.17em; color: rgb(152, 34, 21)">Distributed Design Pattern</a><a href="/tags/career/" style="font-size: 1.15em; color: rgb(64, 12, 170)">Career</a><a href="/tags/linux-performance/" style="font-size: 1.17em; color: rgb(180, 140, 160)">Linux Performance</a><a href="/tags/linux-practice/" style="font-size: 1.27em; color: rgb(191, 7, 122)">Linux Practice</a><a href="/tags/ext4/" style="font-size: 1.15em; color: rgb(115, 153, 178)">ext4</a><a href="/tags/file-system/" style="font-size: 1.15em; color: rgb(29, 106, 41)">File System</a><a href="/tags/math/" style="font-size: 1.16em; color: rgb(140, 37, 19)">Math</a><a href="/tags/microservices-governance/" style="font-size: 1.23em; color: rgb(123, 73, 143)">Microservices Governance</a><a href="/tags/config/" style="font-size: 1.17em; color: rgb(74, 46, 64)">Config</a><a href="/tags/configuration-center/" style="font-size: 1.17em; color: rgb(146, 43, 82)">Configuration Center</a><a href="/tags/apollo/" style="font-size: 1.17em; color: rgb(40, 120, 13)">Apollo</a><a href="/tags/oauth2/" style="font-size: 1.21em; color: rgb(159, 147, 20)">Oauth2</a><a href="/tags/spring-security/" style="font-size: 1.2em; color: rgb(82, 161, 162)">Spring Security</a><a href="/tags/spring-security-oauth2/" style="font-size: 1.2em; color: rgb(132, 130, 8)">Spring Security OAuth2</a><a href="/tags/vim/" style="font-size: 1.21em; color: rgb(188, 56, 32)">Vim</a><a href="/tags/web/" style="font-size: 1.22em; color: rgb(56, 81, 152)">Web</a><a href="/tags/javascript/" style="font-size: 1.2em; color: rgb(39, 0, 131)">JavaScript</a><a href="/tags/zookeeper/" style="font-size: 1.16em; color: rgb(7, 13, 49)">Zookeeper</a><a href="/tags/distributed-lock/" style="font-size: 1.15em; color: rgb(177, 193, 186)">Distributed Lock</a><a href="/tags/jwt/" style="font-size: 1.15em; color: rgb(123, 63, 138)">JWT</a><a href="/tags/bio/" style="font-size: 1.15em; color: rgb(78, 44, 188)">BIO</a><a href="/tags/tomcat/" style="font-size: 1.15em; color: rgb(7, 125, 13)">Tomcat</a><a href="/tags/select/" style="font-size: 1.15em; color: rgb(7, 182, 146)">Select</a><a href="/tags/poll/" style="font-size: 1.15em; color: rgb(143, 105, 111)">Poll</a><a href="/tags/zero-copy/" style="font-size: 1.15em; color: rgb(14, 116, 73)">Zero Copy</a><a href="/tags/mmap/" style="font-size: 1.15em; color: rgb(14, 31, 132)">mmap</a><a href="/tags/reactor/" style="font-size: 1.15em; color: rgb(106, 69, 117)">Reactor</a><a href="/tags/zab/" style="font-size: 1.15em; color: rgb(197, 68, 165)">ZAB</a><a href="/tags/etcd/" style="font-size: 1.15em; color: rgb(64, 114, 7)">etcd</a><a href="/tags/raft/" style="font-size: 1.15em; color: rgb(91, 130, 89)">raft</a><a href="/tags/performance-tuning/" style="font-size: 1.15em; color: rgb(139, 49, 45)">Performance Tuning</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">January 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">December 2022</span><span class="card-archive-list-count">31</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">November 2022</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">October 2022</span><span class="card-archive-list-count">31</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">September 2022</span><span class="card-archive-list-count">15</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/07/"><span class="card-archive-list-date">July 2022</span><span class="card-archive-list-count">18</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">May 2022</span><span class="card-archive-list-count">15</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">April 2022</span><span class="card-archive-list-count">9</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">459</div></div><div class="webinfo-item"><div class="item-name">Run time :</div><div class="item-count" id="runtimeshow" data-publishDate="2015-06-30T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">808.2k</div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-11-09T01:18:51.003Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.pixabay.com/photo/2018/08/27/15/17/fishing-3635221_1280.png')"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2023 By zhongmingmao</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Life is like a box of chocolates. You can't know what you'll eat until you open it.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["Stay hungry, stay foolish."])
  } else {
    document.getElementById("subtitle").innerHTML = 'Stay hungry, stay foolish.'
  }
}
typedJSFn.run(subtitleType)</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>