<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>ByteCoding</title><meta name="author" content="zhongmingmao"><meta name="copyright" content="zhongmingmao"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Focus on Infrastructure">
<meta property="og:type" content="website">
<meta property="og:title" content="ByteCoding">
<meta property="og:url" content="https://blog.zhongmingmao.top/page/42/index.html">
<meta property="og:site_name" content="ByteCoding">
<meta property="og:description" content="Focus on Infrastructure">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png">
<meta property="article:author" content="zhongmingmao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="shortcut icon" href="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png"><link rel="canonical" href="https://blog.zhongmingmao.top/page/42/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":512,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":256},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":32,"languages":{"author":"Author: zhongmingmao","link":"Link: ","source":"Source: ByteCoding","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ByteCoding',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-02-17 13:59:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="ByteCoding" type="application/atom+xml">
</head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">619</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">189</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">80</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://cdn.pixabay.com/photo/2022/10/16/13/53/early-morning-7525151_1280.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="ByteCoding"><span class="site-name">ByteCoding</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">ByteCoding</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2019/09/15/kafka-process-request/" title="Kafka -- 处理请求"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-21.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- 处理请求"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/15/kafka-process-request/" title="Kafka -- 处理请求">Kafka -- 处理请求</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-15T01:44:40.000Z" title="Created 2019-09-15 09:44:40">2019-09-15</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">请求协议
Kafka自定义了一组请求协议，用于实现各种各样的交互操作
PRODUCE请求用于生产消息，FETCH请求用于消费消息，METADATA请求用于请求Kafka集群元数据信息


Kafka 2.3总共定义了45种请求格式，所有请求都通过TCP网络以Socket的方式进行通讯



处理请求方案顺序处理实现简单，但吞吐量太差，只适用于请求发送非常不频繁的场景
1234while (true) &#123;    Request request = accept(connection);    handle(request);&#125;

单独线程处理为每个请求都创建一个新的线程异步处理，完全异步，但开销极大，只适用于请求发送频率很低的场景
12345while (true) &#123;    Request request = accept(connection);    Thread thread = new Thread(() -&gt; &#123; handle(request); &#125;);    thread.start();&#125;

Reactor模式


Reactor ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/09/14/kafka-replication/" title="Kafka -- 副本"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-12.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- 副本"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/14/kafka-replication/" title="Kafka -- 副本">Kafka -- 副本</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-14T10:33:30.000Z" title="Created 2019-09-14 18:33:30">2019-09-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">副本机制的优点
提供数据冗余
即使系统部分组件失效，系统依然能够继续运转，增加了整体可用性和数据持久性


提供高伸缩性
支持横向扩展，能够通过增加机器的方式来提升读性能，进而提高读操作吞吐量


改善数据局部性
允许将数据放入与用户地理位置相近的地方，从而降低系统延时


Kafka只能享受副本机制提供数据冗余实现的高可用性和高持久性



副本定义
Kafka主题划分为若干个分区，副本的概念上是在分区层级下定义的，每个分区配置若干个副本
副本：本质上是一个_只能追加写消息的提交日志_
同一个分区下的所有副本保存有相同的消息序列，这些副本分散保存在不同的Broker上，提高了数据可用性


实际生产环境中，每台Broker都可能保存有各个主题不同分区的不同副本



副本角色


Kafka采用基于领导者（Leader-based）的副本机制
副本分为两类：领导者副本（Leader Replica）和追随者副本（Follower Replica）
每个分区在创建时都要选举一个副本，称为领导者副本，其余的副本自动称为追随者副本


追随者副本是不对外提供服务的，所有的读写请求都必须发往领导者副本所在的Brok ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/09/13/java-performance-jvm-heap-allocation/" title="Java性能 -- JVM堆内存分配"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java性能 -- JVM堆内存分配"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/13/java-performance-jvm-heap-allocation/" title="Java性能 -- JVM堆内存分配">Java性能 -- JVM堆内存分配</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-13T14:11:03.000Z" title="Created 2019-09-13 22:11:03">2019-09-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">Java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/performance/">Performance</a></span></div><div class="content">JVM内存分配性能问题
JVM内存分配不合理最直接的表现就是频繁的GC，这会导致上下文切换，从而降低系统的吞吐量，增加系统的响应时间

对象在堆中的生命周期
在JVM内存模型的堆中，堆被划分为新生代和老年代
新生代又被进一步划分为Eden区和Survivor区，Survivor区由From Survivor和To Survivor组成


当创建一个对象时，对象会被优先分配到新生代的Eden区
此时JVM会给对象定义一个对象年轻计数器（-XX:MaxTenuringThreshold）


当Eden空间不足时，JVM将执行新生代的垃圾回收（Minor GC）
JVM会把存活的对象转移到Survivor中，并且对象年龄+1
对象在Survivor中同样也会经历Minor GC，每经历一次Minor GC，对象年龄都会+1


如果分配的对象超过了-XX:PetenureSizeThreshold，对象会直接被分配到老年代



查看JVM堆内存分配
在默认不配置JVM堆内存大小的情况下，JVM根据默认值来配置当前内存大小
在JDK 1.7中，默认情况下新生代和老年代的比例是1:2，可以通过–XX:NewRat ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/09/12/kafka-monitor-consume-progress/" title="Kafka -- 监控消费进度"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-13.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- 监控消费进度"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/12/kafka-monitor-consume-progress/" title="Kafka -- 监控消费进度">Kafka -- 监控消费进度</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-12T07:20:35.000Z" title="Created 2019-09-12 15:20:35">2019-09-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">Consumer Lag
Consumer Lag（滞后程度）：消费者当前落后于生产者的程度
Lag的单位是消息数，一般是在主题的级别上讨论Lag，但Kafka是在分区的级别上监控Lag，因此需要手动汇总
对于消费者而言，Lag是最重要的监控指标，直接反应了一个消费者的运行情况
一个正常工作的消费者，它的Lag值应该很小，甚至接近于0，滞后程度很小
如果Lag很大，表明消费者无法跟上生产者的速度，Lag会越来越大
极有可能导致消费者消费的数据已经不在操作系统的页缓存中了，这些数据会失去享有Zero Copy技术的资格
这样消费者不得不从磁盘读取这些数据，这将进一步拉大与生产者的差距
马太效应：_Lag原本就很大的消费者会越来越慢，Lag也会也来越大_







监控LagKafka自带命令
kafka-consumer-groups是Kafka提供的最直接的监控消费者消费进度的工具
也能监控独立消费者的Lag，独立消费者是没有使用消费者组机制的消费者程序，也要配置group.id
消费者组要调用KafkaConsumer.subscribe，独立消费者要调用KafkaConsumer.assign直接消费 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/09/11/java-performance-gc/" title="Java性能 -- GC"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-21.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java性能 -- GC"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/11/java-performance-gc/" title="Java性能 -- GC">Java性能 -- GC</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-11T09:31:47.000Z" title="Created 2019-09-11 17:31:47">2019-09-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">Java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/performance/">Performance</a></span></div><div class="content">GC机制回收区域
JVM的内存区域中，程序计数器、虚拟机栈、本地方法栈是线程私有，随线程的创建而创建，销毁而销毁
栈中的栈帧随着方法的进入和退出进行入栈和出栈操作，每个栈帧分配多少内存基本是在类结构确定下来时就已知
因此，这三个区域的内存分配和回收都是具有确定性的


堆中的回收主要是对象回收，方法区的回收主要是废弃常量和无用类的回收



回收时机
当一个对象不再被引用，就代表该对象可以被回收
引用计数法：实现简单，判断效率高，但存在循环引用的问题
可达性分析算法：HotSpot VM




引用类型
功能特点



强引用（Strong Reference）
被强引用关联的对象，永远不会被垃圾回收器回收


软引用（Soft Reference）
被软引用关联的对象，只有当系统将要发生内存溢出时，才会去回收软引用关联的对象


弱引用（Weak Reference）
只被弱引用关联的对象，只要发生GC事件，就会被回收


虚引用（Phantom Reference）
被虚引用关联的对象，唯一作用是在这个对象被回收时收到一个系统通知


回收特性
自动性
Java提供了一个系统级的线程来跟踪每一块分配出去 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/09/10/kafka-consumer-manage-tcp-connection/" title="Kafka -- Java消费者管理TCP连接"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-19.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- Java消费者管理TCP连接"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/10/kafka-consumer-manage-tcp-connection/" title="Kafka -- Java消费者管理TCP连接">Kafka -- Java消费者管理TCP连接</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-10T02:03:46.000Z" title="Created 2019-09-10 10:03:46">2019-09-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">创建TCP连接
消费者端的主要程序入口是KafkaConsumer，但构建KafkaConsumer实例不会创建任何TCP连接
构建KafkaProducer实例时，会在后台默默地启动一个Sender线程，Sender线程负责Socket连接的创建
在Java构造函数中启动线程，会造成this指针逃逸，是一个隐患


消费者的TCP连接是在调用**KafkaConsumer.poll**方法时被创建的，poll方法内部有3个时机可以创建TCP连接



发起FindCoordinator请求时
消费者组有个组件叫作协调者（Coordinator）
驻留在Broker端的内存中，负责消费者组的组成员管理和各个消费者的位移提交管理


当消费者程序首次启动调用poll方法时，需要向Kafka集群（集群中的任意Broker）发送FindCoordinator请求
社区优化：消费者程序会向集群中当前负载最小的那台Broker发送请求
单向负载评估（非最优解）：消费者连接的所有Broker中，谁的待发送请求最少，谁的负载就越小



连接Coordinator时
Broker处理完FindCoordinator请求后， ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/09/09/java-performance-jit/" title="Java性能 -- JIT"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-19.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java性能 -- JIT"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/09/java-performance-jit/" title="Java性能 -- JIT">Java性能 -- JIT</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-09T03:57:01.000Z" title="Created 2019-09-09 11:57:01">2019-09-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">Java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/performance/">Performance</a></span></div><div class="content">编译
前端编译：即常见的**.java文件被编译成.class文件**的过程
运行时编译：机器无法直接运行Java生成的字节码，在运行时，JIT或者解释器会将字节码转换为机器码
类文件在运行时被进一步编译，可以变成高度优化的机器代码


C&#x2F;C++编译器的所有优化都是在编译期完成的，运行期的性能监控仅作为基础的优化措施是无法进行的
JIT编译器是JVM中运行时编译最重要的部分之一



编译 &#x2F; 加载 &#x2F; 执行

类编译
javac：将.java文件编译成.class文件
javap：反编译.class文件，重点关注常量池和方法表集合
常量池主要记录的是类文件中出现的字面量和符号引用
字面量：字符串常量、基本类型的常量
符号引用：类和接口的全限定名、类引用、方法引用、成员变量引用


方法表集合
方法的字节码、方法访问权限、方法名索引、描述符索引、JVM执行指令、属性集合等







类加载
当一个类被创建实例或者被其他对象引用时，JVM如果没有加载过该类，会通过类加载器将**.class文件加载到内存**中
不同的实现类由不同的类加载器加载
JDK中的本地方法类一般由根加载 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/09/08/kafka-multi-thread-consumer/" title="Kafka -- 多线程消费者"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-22.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- 多线程消费者"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/08/kafka-multi-thread-consumer/" title="Kafka -- 多线程消费者">Kafka -- 多线程消费者</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-08T01:55:31.000Z" title="Created 2019-09-08 09:55:31">2019-09-08</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">Kafka Java Consumer设计原理
Kafka Java Consumer从Kafka 0.10.1.0开始，KafkaConsumer变成了双线程设计，即用户主线程和心跳线程
用户主线程：启动Consumer应用程序main方法的那个线程
心跳线程：只负责定期给对应的Broker机器发送心跳请求，以标识消费者应用的存活性


引入心跳线程的另一个目的
将心跳频率和主线程调用KafkaConsumer.poll方法的频率分开，解耦真实的消息处理逻辑和消费组成员存活性管理


虽然有了心跳线程，但实际的消息获取逻辑依然是在用户主线程中完成
因此在消费消息的这个层面，依然可以安全地认为KafkaConsumer是单线程的设计


老版本Consumer是多线程的架构
每个Consumer实例在内部为所有订阅的主题分区创建对应的消息获取线程，即Fetcher线程


老版本Consumer同时也是阻塞式的，Consumer实例启动后，内部会创建很多阻塞式的消息获取迭代器
但在很多场景下，Consumer端有非阻塞需求，如在流处理应用中执行过滤、分组等操作就不能是阻塞式的
基于这个原因，社区为新版本Con ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/09/07/java-performance-jvm-memory-model/" title="Java性能 -- JVM内存模型"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-18.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java性能 -- JVM内存模型"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/07/java-performance-jvm-memory-model/" title="Java性能 -- JVM内存模型">Java性能 -- JVM内存模型</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-07T11:51:47.000Z" title="Created 2019-09-07 19:51:47">2019-09-07</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">Java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/performance/">Performance</a></span></div><div class="content">JVM内存模型



堆
堆是JVM内存中最大的一块内存空间，被所有线程共享，几乎所有对象和数组都被分配到堆内存中
堆被划分为新生代和老年代，新生代又被划分为Eden区和Survivor区（From Survivor + To Survivor）
永久代
在Java 6中，永久代在非堆内存中
在Java 7中，永久代的静态变量和运行时常量池被合并到堆中
在Java 8中，永久代被元空间取代





程序计数器
程序计数器是一块很小的内存空间，主要用来记录各个线程执行的字节码的地址
Java是多线程语言，当执行的线程数量超过CPU数量时，线程之间会根据时间片轮询争夺CPU资源
当一个线程的时间片用完了，或者其他原因导致该线程的CPU资源被提前抢夺
那么退出的线程需要单独的程序计数器来记录下一条运行的指令



方法区
方法区 !&#x3D; 永久代
HotSpot VM使用了永久代来实现方法区，但在其他VM（Oracle JRockit、IBM J9）不存在永久代一说
方法区只是JVM规范的一部分，在HotSpot VM中，使用了永久代来实现JVM规范的方法区
方法区主要用来存放已被虚拟机加载的类相关信息
类 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/09/06/kafka-commit-failed-exception/" title="Kafka -- CommitFailedException"><img class="post-bg" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/go-17.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Kafka -- CommitFailedException"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/09/06/kafka-commit-failed-exception/" title="Kafka -- CommitFailedException">Kafka -- CommitFailedException</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2019-09-06T09:57:04.000Z" title="Created 2019-09-06 17:57:04">2019-09-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/middleware/">Middleware</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/">MQ</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/middleware/mq/kafka/">Kafka</a></span></div><div class="content">CommitFailedException
CommitFailedException是Consumer客户端在提交位移时出现的不可恢复的严重异常
如果异常是可恢复的瞬时错误，提交位移的API方法是支持自动错误重试的，如commitSync方法



解释
Commit cannot be completed since the group has already rebalanced and assigned the partitions to another member. This means that the time between subsequent calls to poll() was longer than the configured max.poll.interval.ms, which typically implies that the poll loop is spending too much time message processing. You can address this either by increasing the max.poll.interval.ms o ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/41/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/41/#content-inner">41</a><span class="page-number current">42</span><a class="page-number" href="/page/43/#content-inner">43</a><span class="space">&hellip;</span><a class="page-number" href="/page/62/#content-inner">62</a><a class="extend next" rel="next" href="/page/43/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://zhongmingmao-1253868755.cos.ap-guangzhou.myqcloud.com/z.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">zhongmingmao</div><div class="author-info__description">Focus on Infrastructure.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">619</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">189</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">80</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:zhongmingmao0625@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Things are always unexpected!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/01/cloud-native-observability-opentelemetry-doc-v1/" title="Observability - OpenTelemetry Doc V1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://observability-1253868755.cos.ap-guangzhou.myqcloud.com/opentelemetry.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Observability - OpenTelemetry Doc V1"/></a><div class="content"><a class="title" href="/2025/01/01/cloud-native-observability-opentelemetry-doc-v1/" title="Observability - OpenTelemetry Doc V1">Observability - OpenTelemetry Doc V1</a><time datetime="2024-12-31T16:06:25.000Z" title="Created 2025-01-01 00:06:25">2025-01-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/18/ebpf-principle/" title="eBPF - Principle"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ebpf-1253868755.cos.ap-guangzhou.myqcloud.com/ebpf-principle.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="eBPF - Principle"/></a><div class="content"><a class="title" href="/2024/10/18/ebpf-principle/" title="eBPF - Principle">eBPF - Principle</a><time datetime="2024-10-17T16:06:25.000Z" title="Created 2024-10-18 00:06:25">2024-10-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/17/ebpf-overview/" title="eBPF - Overview"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://ebpf-1253868755.cos.ap-guangzhou.myqcloud.com/ebpf.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="eBPF - Overview"/></a><div class="content"><a class="title" href="/2024/10/17/ebpf-overview/" title="eBPF - Overview">eBPF - Overview</a><time datetime="2024-10-16T16:06:25.000Z" title="Created 2024-10-17 00:06:25">2024-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/16/java-feature-switch-pattern-matching/" title="Java Feature - Switch Pattern Matching"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/java-feature-switch-pattern-matching.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java Feature - Switch Pattern Matching"/></a><div class="content"><a class="title" href="/2024/10/16/java-feature-switch-pattern-matching/" title="Java Feature - Switch Pattern Matching">Java Feature - Switch Pattern Matching</a><time datetime="2024-10-15T16:06:25.000Z" title="Created 2024-10-16 00:06:25">2024-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/15/java-feature-switch/" title="Java Feature - Switch"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://java-feature-1253868755.cos.ap-guangzhou.myqcloud.com/java-feature-switch.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Java Feature - Switch"/></a><div class="content"><a class="title" href="/2024/10/15/java-feature-switch/" title="Java Feature - Switch">Java Feature - Switch</a><time datetime="2024-10-14T16:06:25.000Z" title="Created 2024-10-15 00:06:25">2024-10-15</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/"><span class="card-category-list-name">AI</span><span class="card-category-list-count">34</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/llm/"><span class="card-category-list-name">LLM</span><span class="card-category-list-count">16</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/ai/rag/"><span class="card-category-list-name">RAG</span><span class="card-category-list-count">18</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/"><span class="card-category-list-name">Big Data</span><span class="card-category-list-count">26</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/beam/"><span class="card-category-list-name">Beam</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/big-data/spark/"><span class="card-category-list-name">Spark</span><span class="card-category-list-count">6</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/career/"><span class="card-category-list-name">Career</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/cloud-computing/"><span class="card-category-list-name">Cloud Computing</span><span class="card-category-list-count">10</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/big-data/" style="font-size: 1.31em; color: rgb(123, 197, 108)">Big Data</a><a href="/tags/beam/" style="font-size: 1.24em; color: rgb(65, 156, 94)">Beam</a><a href="/tags/spark/" style="font-size: 1.2em; color: rgb(171, 15, 154)">Spark</a><a href="/tags/flink/" style="font-size: 1.15em; color: rgb(58, 121, 72)">Flink</a><a href="/tags/mapreduce/" style="font-size: 1.15em; color: rgb(116, 73, 30)">MapReduce</a><a href="/tags/rdd/" style="font-size: 1.15em; color: rgb(160, 50, 39)">RDD</a><a href="/tags/cloud-computing/" style="font-size: 1.22em; color: rgb(110, 94, 146)">Cloud Computing</a><a href="/tags/iaas/" style="font-size: 1.19em; color: rgb(45, 173, 127)">IaaS</a><a href="/tags/paas/" style="font-size: 1.19em; color: rgb(104, 14, 77)">PaaS</a><a href="/tags/cloud-native/" style="font-size: 1.45em; color: rgb(11, 124, 48)">Cloud Native</a><a href="/tags/kubernetes/" style="font-size: 1.43em; color: rgb(54, 170, 85)">Kubernetes</a><a href="/tags/devops/" style="font-size: 1.18em; color: rgb(31, 186, 37)">DevOps</a><a href="/tags/go-core/" style="font-size: 1.17em; color: rgb(188, 21, 21)">Go Core</a><a href="/tags/go/" style="font-size: 1.42em; color: rgb(115, 9, 155)">Go</a><a href="/tags/container/" style="font-size: 1.26em; color: rgb(10, 196, 128)">Container</a><a href="/tags/docker/" style="font-size: 1.28em; color: rgb(179, 50, 154)">Docker</a><a href="/tags/go-engineering/" style="font-size: 1.33em; color: rgb(61, 186, 174)">Go Engineering</a><a href="/tags/swagger/" style="font-size: 1.15em; color: rgb(129, 165, 128)">Swagger</a><a href="/tags/rpc/" style="font-size: 1.16em; color: rgb(64, 4, 184)">RPC</a><a href="/tags/grpc/" style="font-size: 1.16em; color: rgb(171, 95, 75)">gRPC</a><a href="/tags/ci/" style="font-size: 1.15em; color: rgb(45, 100, 57)">CI</a><a href="/tags/makefile/" style="font-size: 1.15em; color: rgb(4, 137, 82)">Makefile</a><a href="/tags/network/" style="font-size: 1.16em; color: rgb(164, 42, 176)">Network</a><a href="/tags/cloud-native-foundation/" style="font-size: 1.32em; color: rgb(186, 113, 40)">Cloud Native Foundation</a><a href="/tags/linux/" style="font-size: 1.27em; color: rgb(198, 17, 121)">Linux</a><a href="/tags/dockerfile/" style="font-size: 1.17em; color: rgb(191, 68, 24)">Dockerfile</a><a href="/tags/service-mesh/" style="font-size: 1.18em; color: rgb(99, 135, 86)">Service Mesh</a><a href="/tags/microservices/" style="font-size: 1.27em; color: rgb(109, 139, 106)">Microservices</a><a href="/tags/spring-cloud/" style="font-size: 1.2em; color: rgb(196, 183, 121)">Spring Cloud</a><a href="/tags/spring/" style="font-size: 1.23em; color: rgb(191, 96, 172)">Spring</a><a href="/tags/java/" style="font-size: 1.44em; color: rgb(128, 31, 92)">Java</a><a href="/tags/service-governance/" style="font-size: 1.17em; color: rgb(136, 147, 144)">Service Governance</a><a href="/tags/opa/" style="font-size: 1.2em; color: rgb(64, 32, 162)">OPA</a><a href="/tags/alibaba/" style="font-size: 1.21em; color: rgb(103, 188, 10)">Alibaba</a><a href="/tags/observability/" style="font-size: 1.19em; color: rgb(86, 195, 24)">Observability</a><a href="/tags/security/" style="font-size: 1.26em; color: rgb(156, 194, 191)">Security</a><a href="/tags/compliance/" style="font-size: 1.17em; color: rgb(184, 2, 29)">Compliance</a><a href="/tags/infrastructure/" style="font-size: 1.3em; color: rgb(171, 5, 91)">Infrastructure</a><a href="/tags/architecture/" style="font-size: 1.31em; color: rgb(92, 39, 119)">Architecture</a><a href="/tags/serverless/" style="font-size: 1.21em; color: rgb(81, 93, 164)">Serverless</a><a href="/tags/faas/" style="font-size: 1.21em; color: rgb(154, 62, 71)">FaaS</a><a href="/tags/computer-basics/" style="font-size: 1.35em; color: rgb(124, 108, 71)">Computer Basics</a><a href="/tags/computer-organization/" style="font-size: 1.35em; color: rgb(17, 6, 153)">Computer Organization</a><a href="/tags/knowledge-map/" style="font-size: 1.15em; color: rgb(55, 135, 108)">Knowledge Map</a><a href="/tags/ebpf/" style="font-size: 1.16em; color: rgb(176, 45, 170)">eBPF</a><a href="/tags/tool/" style="font-size: 1.22em; color: rgb(93, 84, 21)">Tool</a><a href="/tags/git/" style="font-size: 1.22em; color: rgb(118, 198, 79)">Git</a><a href="/tags/concurrency/" style="font-size: 1.15em; color: rgb(200, 26, 164)">Concurrency</a><a href="/tags/cloud/" style="font-size: 1.36em; color: rgb(46, 86, 139)">Cloud</a><a href="/tags/native/" style="font-size: 1.36em; color: rgb(64, 138, 27)">Native</a><a href="/tags/authentication/" style="font-size: 1.17em; color: rgb(44, 26, 11)">Authentication</a><a href="/tags/ldap/" style="font-size: 1.15em; color: rgb(77, 144, 92)">LDAP</a><a href="/tags/oauth-2-0/" style="font-size: 1.2em; color: rgb(171, 169, 118)">OAuth 2.0</a><a href="/tags/storage/" style="font-size: 1.4em; color: rgb(86, 102, 9)">Storage</a><a href="/tags/mysql/" style="font-size: 1.41em; color: rgb(114, 175, 95)">MySQL</a><a href="/tags/innodb/" style="font-size: 1.2em; color: rgb(120, 193, 187)">InnoDB</a><a href="/tags/java-concurrent/" style="font-size: 1.38em; color: rgb(105, 93, 107)">Java Concurrent</a><a href="/tags/actor/" style="font-size: 1.15em; color: rgb(137, 39, 179)">Actor</a><a href="/tags/akka/" style="font-size: 1.15em; color: rgb(111, 152, 37)">Akka</a><a href="/tags/coroutine/" style="font-size: 1.16em; color: rgb(136, 45, 34)">Coroutine</a><a href="/tags/csp/" style="font-size: 1.15em; color: rgb(190, 104, 69)">CSP</a><a href="/tags/disruptor/" style="font-size: 1.15em; color: rgb(179, 97, 62)">Disruptor</a><a href="/tags/netty/" style="font-size: 1.15em; color: rgb(12, 73, 200)">Netty</a><a href="/tags/stm/" style="font-size: 1.15em; color: rgb(178, 163, 112)">STM</a><a href="/tags/mvcc/" style="font-size: 1.15em; color: rgb(33, 174, 43)">MVCC</a><a href="/tags/java-core/" style="font-size: 1.2em; color: rgb(7, 138, 84)">Java Core</a><a href="/tags/java-feature/" style="font-size: 1.2em; color: rgb(122, 6, 119)">Java Feature</a><a href="/tags/java-performance/" style="font-size: 1.33em; color: rgb(186, 18, 178)">Java Performance</a><a href="/tags/cas/" style="font-size: 1.15em; color: rgb(74, 100, 106)">CAS</a><a href="/tags/design-pattern/" style="font-size: 1.18em; color: rgb(197, 109, 66)">Design Pattern</a><a href="/tags/hashtable/" style="font-size: 1.15em; color: rgb(142, 142, 51)">HashTable</a><a href="/tags/concurrenthashmap/" style="font-size: 1.15em; color: rgb(140, 40, 144)">ConcurrentHashMap</a><a href="/tags/concurrentskiplistmap/" style="font-size: 1.15em; color: rgb(86, 8, 75)">ConcurrentSkipListMap</a><a href="/tags/consistency/" style="font-size: 1.15em; color: rgb(6, 192, 175)">Consistency</a><a href="/tags/jvm/" style="font-size: 1.37em; color: rgb(113, 183, 129)">JVM</a><a href="/tags/gc/" style="font-size: 1.16em; color: rgb(28, 2, 123)">GC</a><a href="/tags/hashmap/" style="font-size: 1.15em; color: rgb(91, 63, 190)">HashMap</a><a href="/tags/io/" style="font-size: 1.15em; color: rgb(6, 121, 184)">IO</a><a href="/tags/nio/" style="font-size: 1.16em; color: rgb(58, 22, 42)">NIO</a><a href="/tags/aio/" style="font-size: 1.16em; color: rgb(113, 74, 62)">AIO</a><a href="/tags/epoll/" style="font-size: 1.16em; color: rgb(197, 126, 111)">Epoll</a><a href="/tags/jit/" style="font-size: 1.15em; color: rgb(36, 150, 90)">JIT</a><a href="/tags/synchronized/" style="font-size: 1.16em; color: rgb(10, 155, 20)">synchronized</a><a href="/tags/lock/" style="font-size: 1.15em; color: rgb(169, 56, 31)">Lock</a><a href="/tags/reentrantreadwritelock/" style="font-size: 1.15em; color: rgb(99, 135, 78)">ReentrantReadWriteLock</a><a href="/tags/stampedlock/" style="font-size: 1.15em; color: rgb(148, 27, 198)">StampedLock</a><a href="/tags/serialization/" style="font-size: 1.15em; color: rgb(157, 1, 151)">Serialization</a><a href="/tags/protobuf/" style="font-size: 1.15em; color: rgb(54, 100, 62)">ProtoBuf</a><a href="/tags/java-stream/" style="font-size: 1.15em; color: rgb(160, 39, 134)">Java Stream</a><a href="/tags/mark-word/" style="font-size: 1.15em; color: rgb(46, 74, 40)">Mark Word</a><a href="/tags/monitor/" style="font-size: 1.15em; color: rgb(9, 31, 117)">Monitor</a><a href="/tags/context-switch/" style="font-size: 1.15em; color: rgb(34, 85, 6)">Context Switch</a><a href="/tags/lambda/" style="font-size: 1.15em; color: rgb(161, 54, 187)">Lambda</a><a href="/tags/thread-pool/" style="font-size: 1.15em; color: rgb(17, 39, 81)">Thread Pool</a><a href="/tags/bytecode-manipulation/" style="font-size: 1.17em; color: rgb(131, 171, 149)">Bytecode Manipulation</a><a href="/tags/asm/" style="font-size: 1.15em; color: rgb(80, 146, 121)">ASM</a><a href="/tags/jol/" style="font-size: 1.17em; color: rgb(41, 55, 107)">JOL</a><a href="/tags/middleware/" style="font-size: 1.39em; color: rgb(73, 117, 100)">Middleware</a><a href="/tags/mq/" style="font-size: 1.4em; color: rgb(24, 65, 4)">MQ</a><a href="/tags/kafka/" style="font-size: 1.39em; color: rgb(126, 143, 119)">Kafka</a><a href="/tags/stream/" style="font-size: 1.39em; color: rgb(182, 111, 22)">Stream</a><a href="/tags/rebalance/" style="font-size: 1.17em; color: rgb(65, 8, 3)">Rebalance</a><a href="/tags/avro/" style="font-size: 1.18em; color: rgb(165, 200, 90)">Avro</a><a href="/tags/compression/" style="font-size: 1.15em; color: rgb(60, 107, 120)">Compression</a><a href="/tags/consumer-group/" style="font-size: 1.15em; color: rgb(59, 66, 92)">Consumer Group</a><a href="/tags/tcp/" style="font-size: 1.16em; color: rgb(120, 42, 125)">TCP</a><a href="/tags/idempotence/" style="font-size: 1.15em; color: rgb(23, 89, 113)">Idempotence</a><a href="/tags/producer/" style="font-size: 1.15em; color: rgb(151, 113, 133)">Producer</a><a href="/tags/load-balance/" style="font-size: 1.15em; color: rgb(9, 122, 48)">Load Balance</a><a href="/tags/distributed-architecture/" style="font-size: 1.15em; color: rgb(56, 108, 143)">Distributed Architecture</a><a href="/tags/distributed-design-pattern/" style="font-size: 1.17em; color: rgb(38, 144, 188)">Distributed Design Pattern</a><a href="/tags/career/" style="font-size: 1.15em; color: rgb(157, 46, 70)">Career</a><a href="/tags/linux-performance/" style="font-size: 1.17em; color: rgb(46, 38, 111)">Linux Performance</a><a href="/tags/linux-practice/" style="font-size: 1.24em; color: rgb(51, 166, 104)">Linux Practice</a><a href="/tags/ext4/" style="font-size: 1.15em; color: rgb(45, 134, 62)">ext4</a><a href="/tags/file-system/" style="font-size: 1.15em; color: rgb(90, 181, 42)">File System</a><a href="/tags/ai/" style="font-size: 1.34em; color: rgb(125, 163, 93)">AI</a><a href="/tags/llm/" style="font-size: 1.34em; color: rgb(42, 38, 23)">LLM</a><a href="/tags/nlp/" style="font-size: 1.25em; color: rgb(117, 55, 154)">NLP</a><a href="/tags/python/" style="font-size: 1.3em; color: rgb(73, 79, 188)">Python</a><a href="/tags/fastapi/" style="font-size: 1.15em; color: rgb(165, 54, 124)">FastAPI</a><a href="/tags/uvicorn/" style="font-size: 1.15em; color: rgb(142, 54, 97)">Uvicorn</a><a href="/tags/chatgpt/" style="font-size: 1.15em; color: rgb(141, 67, 43)">ChatGPT</a><a href="/tags/machine-learning/" style="font-size: 1.17em; color: rgb(104, 89, 111)">Machine Learning</a><a href="/tags/rnn/" style="font-size: 1.15em; color: rgb(180, 172, 187)">RNN</a><a href="/tags/seq2seq/" style="font-size: 1.16em; color: rgb(4, 52, 122)">Seq2Seq</a><a href="/tags/word2vec/" style="font-size: 1.15em; color: rgb(13, 41, 101)">Word2Vec</a><a href="/tags/langchain/" style="font-size: 1.19em; color: rgb(20, 107, 192)">LangChain</a><a href="/tags/ai-agent/" style="font-size: 1.18em; color: rgb(120, 71, 162)">AI Agent</a><a href="/tags/rag/" style="font-size: 1.29em; color: rgb(122, 200, 105)">RAG</a><a href="/tags/lora/" style="font-size: 1.15em; color: rgb(37, 188, 19)">LoRA</a><a href="/tags/peft/" style="font-size: 1.15em; color: rgb(90, 138, 189)">PEFT</a><a href="/tags/faiss/" style="font-size: 1.15em; color: rgb(144, 64, 109)">Faiss</a><a href="/tags/math/" style="font-size: 1.16em; color: rgb(86, 70, 129)">Math</a><a href="/tags/microservices-governance/" style="font-size: 1.21em; color: rgb(54, 81, 122)">Microservices Governance</a><a href="/tags/config/" style="font-size: 1.17em; color: rgb(164, 128, 46)">Config</a><a href="/tags/configuration-center/" style="font-size: 1.17em; color: rgb(150, 145, 76)">Configuration Center</a><a href="/tags/apollo/" style="font-size: 1.17em; color: rgb(105, 200, 197)">Apollo</a><a href="/tags/oauth2/" style="font-size: 1.2em; color: rgb(164, 161, 76)">Oauth2</a><a href="/tags/spring-security/" style="font-size: 1.19em; color: rgb(200, 11, 24)">Spring Security</a><a href="/tags/spring-security-oauth2/" style="font-size: 1.19em; color: rgb(120, 81, 71)">Spring Security OAuth2</a><a href="/tags/chatops/" style="font-size: 1.15em; color: rgb(34, 11, 149)">ChatOps</a><a href="/tags/chatbot/" style="font-size: 1.15em; color: rgb(133, 127, 43)">Chatbot</a><a href="/tags/graphrag/" style="font-size: 1.15em; color: rgb(65, 23, 95)">GraphRAG</a><a href="/tags/rerank/" style="font-size: 1.15em; color: rgb(73, 48, 117)">Rerank</a><a href="/tags/kg-rag/" style="font-size: 1.15em; color: rgb(132, 141, 139)">KG-RAG</a><a href="/tags/prompting/" style="font-size: 1.15em; color: rgb(2, 4, 147)">Prompting</a><a href="/tags/vector/" style="font-size: 1.16em; color: rgb(96, 160, 62)">Vector</a><a href="/tags/vim/" style="font-size: 1.2em; color: rgb(141, 12, 160)">Vim</a><a href="/tags/web/" style="font-size: 1.2em; color: rgb(200, 176, 151)">Web</a><a href="/tags/javascript/" style="font-size: 1.19em; color: rgb(137, 36, 7)">JavaScript</a><a href="/tags/zookeeper/" style="font-size: 1.16em; color: rgb(93, 26, 146)">Zookeeper</a><a href="/tags/distributed-lock/" style="font-size: 1.15em; color: rgb(28, 105, 186)">Distributed Lock</a><a href="/tags/istio/" style="font-size: 1.17em; color: rgb(115, 40, 191)">Istio</a><a href="/tags/jwt/" style="font-size: 1.15em; color: rgb(89, 198, 73)">JWT</a><a href="/tags/bio/" style="font-size: 1.15em; color: rgb(103, 78, 64)">BIO</a><a href="/tags/tomcat/" style="font-size: 1.15em; color: rgb(88, 49, 151)">Tomcat</a><a href="/tags/select/" style="font-size: 1.15em; color: rgb(164, 31, 163)">Select</a><a href="/tags/poll/" style="font-size: 1.15em; color: rgb(168, 148, 167)">Poll</a><a href="/tags/zero-copy/" style="font-size: 1.15em; color: rgb(59, 195, 70)">Zero Copy</a><a href="/tags/mmap/" style="font-size: 1.15em; color: rgb(95, 117, 171)">mmap</a><a href="/tags/reactor/" style="font-size: 1.15em; color: rgb(37, 188, 172)">Reactor</a><a href="/tags/transformer/" style="font-size: 1.16em; color: rgb(81, 112, 162)">Transformer</a><a href="/tags/svm/" style="font-size: 1.15em; color: rgb(180, 62, 45)">SVM</a><a href="/tags/attention/" style="font-size: 1.15em; color: rgb(53, 19, 19)">Attention</a><a href="/tags/zab/" style="font-size: 1.15em; color: rgb(107, 191, 46)">ZAB</a><a href="/tags/etcd/" style="font-size: 1.15em; color: rgb(133, 161, 171)">etcd</a><a href="/tags/raft/" style="font-size: 1.15em; color: rgb(85, 36, 60)">raft</a><a href="/tags/iac/" style="font-size: 1.15em; color: rgb(182, 170, 176)">IaC</a><a href="/tags/terraform/" style="font-size: 1.15em; color: rgb(37, 150, 114)">Terraform</a><a href="/tags/crossplane/" style="font-size: 1.15em; color: rgb(17, 40, 141)">Crossplane</a><a href="/tags/pulumi/" style="font-size: 1.15em; color: rgb(90, 25, 43)">Pulumi</a><a href="/tags/argo-cd/" style="font-size: 1.15em; color: rgb(87, 149, 185)">Argo CD</a><a href="/tags/vpc/" style="font-size: 1.15em; color: rgb(11, 31, 52)">VPC</a><a href="/tags/helm/" style="font-size: 1.15em; color: rgb(84, 75, 104)">Helm</a><a href="/tags/runc/" style="font-size: 1.15em; color: rgb(64, 51, 48)">runc</a><a href="/tags/kustomize/" style="font-size: 1.15em; color: rgb(44, 13, 56)">Kustomize</a><a href="/tags/oci/" style="font-size: 1.15em; color: rgb(27, 107, 185)">OCI</a><a href="/tags/buildkit/" style="font-size: 1.15em; color: rgb(145, 152, 97)">BuildKit</a><a href="/tags/crane/" style="font-size: 1.15em; color: rgb(141, 25, 113)">crane</a><a href="/tags/oci-image/" style="font-size: 1.15em; color: rgb(72, 195, 31)">OCI Image</a><a href="/tags/oci-runtime/" style="font-size: 1.15em; color: rgb(55, 193, 42)">OCI Runtime</a><a href="/tags/linux-namespace/" style="font-size: 1.15em; color: rgb(160, 0, 103)">Linux Namespace</a><a href="/tags/linux-cgroup/" style="font-size: 1.15em; color: rgb(96, 30, 73)">Linux CGroup</a><a href="/tags/k8s-manifest/" style="font-size: 1.15em; color: rgb(79, 191, 175)">K8S Manifest</a><a href="/tags/performance-tuning/" style="font-size: 1.15em; color: rgb(165, 59, 33)">Performance Tuning</a><a href="/tags/api-gateway/" style="font-size: 1.15em; color: rgb(39, 145, 78)">API Gateway</a><a href="/tags/apisix/" style="font-size: 1.15em; color: rgb(112, 29, 143)">APISIX</a><a href="/tags/opentelemetry/" style="font-size: 1.15em; color: rgb(157, 56, 161)">OpenTelemetry</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span><a class="card-more-btn" href="/archives/" title="More">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">January 2025</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><span class="card-archive-list-count">18</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><span class="card-archive-list-count">30</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">August 2024</span><span class="card-archive-list-count">31</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">June 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">May 2023</span><span class="card-archive-list-count">11</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">April 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">619</div></div><div class="webinfo-item"><div class="item-name">Run time :</div><div class="item-count" id="runtimeshow" data-publishDate="2015-06-30T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">1181.4k</div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-02-17T05:59:21.278Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.pixabay.com/photo/2018/08/27/15/17/fishing-3635221_1280.png')"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2025 By zhongmingmao</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Life is like a box of chocolates. You can't know what you'll eat until you open it.</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["Stay hungry, stay foolish."])
  } else {
    document.getElementById("subtitle").innerHTML = 'Stay hungry, stay foolish.'
  }
}
typedJSFn.run(subtitleType)</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>