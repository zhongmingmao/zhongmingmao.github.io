---
title: LLM Core - Machine Learning Concept
mathjax: false
date: 2024-07-02 00:06:25
cover: https://llm-1253868755.cos.ap-guangzhou.myqcloud.com/llm-ml.webp
categories:
  - AI
  - LLM
tags:
  - AI
  - LLM
  - NLP
  - Machine Learning
---

# 机器学习

1. 机器学习是让计算机**利用数据**来**学习**如何**完成任务**
2. 机器学习允许计算机通过**分析**和**学习**数据来**自我改进**以及**作出决策**

<!-- more -->

## 房价预测

> 利用 **scikit-learn** 进行预测

### 数据集

> housing_data.csv

| 面积 | 卧室数量 | 地理位置 | 售价 |
| ---- | -------- | -------- | ---- |
| 100  | 2        | 1        | 300  |
| 150  | 3        | 2        | 450  |
| 120  | 2        | 2        | 350  |
| 80   | 1        | 1        | 220  |

### 线性回归

```python
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
import pandas as pd

# 加载数据集
data = pd.read_csv("housing_data.csv")  # 假设这是我们的房屋数据

# 准备数据
X = data[['面积', '卧室数量', '地理位置']]  # 特征
y = data['售价']  # 目标变量

# 划分数据集
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# 初始化模型
model = LinearRegression()

# 训练模型
model.fit(X_train, y_train)

# 使用模型进行预测
predictions = model.predict(X_test)

# 现在，`predictions`包含了我们模型预测的房价
print(predictions)  # [462.45942572]
```

1. **特征 X** 是一个**二维数组**，包含 3 列 - 面积 + 卧室数量 + 地理位置
2. **目标 y** 是一个**一维数组**，包含 1 列 - 售价
3. train_test_split
   - 将数据集分割成**训练集**和**测试集**
   - **训练集**用于**训练模型**，而**测试集**用于**评估模型性能**
   - 评估的目的 - 检查模型对于**未见过**的数据的**泛化**能力
4. test_size 表示**测试集**在整个数据集中的**比例**
5. random_state 为**整数**，用于控制**随机数生成器**的状态
   - **伪随机** - 提供一个**确切的值**可以确保**每次分割**都是**相同**的

## 小结

1. 使用机器学习从**数据**中**学习规律**，并应用这些规律来作出**预测**
2. 机器学习的真正魅力在于它的**广泛使用**
   - 简单任务 - 房价预测
   - 复杂任务 - 自动驾驶
3.  LLM 实际是各种机器学习技术的**叠加**

# 深度学习

> 机器学习的重要分支

## 概述

1. 深度学习主要以**深度神经网络**为主 - Deep Neural Networks - **DNNs**
2. 神经网络的结构**模拟**了**人类大脑**，由**多层神经元**组成
3. 人类大脑
   - 大约 **1000 亿个神经元**，每个神经元通过**突触**与其它 **1000** 个神经元产生连接
   - 大约 **100 万亿个突触**
4. LLM 的**参数规模** ≈ 大脑的**突触数量**
   - GPT-3 - 1750 亿个参数 - **1.75 亿个神经元**
   - 智商约定于人类的 **0.175%**
5. 深度学习的强大之处 - **深度神经网络**
   - 一个**多层**的神经网络结构，**每一层**都可以**学习**到**不同级别的特征**

## 图片识别

> 识别图片中是否有猫

1. **准备数据**
   - 训练集 + 测试集
2. **构建模型**
   - 在构建神经网络时，可以让**前面的层**学习**边缘**和**纹理**
   - **更深的层**则学习如何**组合**这些**特征**来识别**更复杂**的形状和对象 - 猫耳朵、猫鼻子
3. **训练模型**
   - 输入**大量**的图片来**训练**网络
   - 通过**调整内部参数（权重）**使得**预测错误最小化**
   - 相比于 **LLM**，不具备很强的**泛化迁移**能力
4. **评估+使用**
   - 训练完成后，可以用模型来对图片进行**分类**

## 层类型

| Layer  | Desc                                                         |
| ------ | ------------------------------------------------------------ |
| 输入层 | 接收**原始数据**输入 - 如图片像素值等                        |
| 隐藏层 | 多层级，每一层通过**数学函数**转换数据，逐步**提取**和**学习**数据的**特征**<br />**较低层级** - 学习**简单特征**，如边缘和纹理<br />**更深层级** - 学习**复杂特征**，如对象的部分和整体特征 |
| 输出层 | 根据**学到的特征**作出最终的**预测**或者**分类**             |

## 反向传播

1. 在训练过程中，模型通过**反向传播**算法**自动调整**其**内部参数** - 即**权重**或者**偏差**
2. 目的 - **最小化**模型预测和实际结果之间的**差异**
3. 整个过程需要大量的**数据**和**计算**资源

# 学习过程

> 机器学习的**工程化**实践

## 定义问题

> **LLM** 具有很好的**泛化迁移**能力，不需要预先定义问题

1. 明确希望机器学习解决的问题
2. **分类**问题 / **回归**问题 / **聚类**问题

## 收集数据

1. 数据是机器学习的**基础**，收集**足够多**、**质量好**的数据
2. 收集方式 - <u>公开数据集 / 公司内部数据 / 网络爬虫</u>
3. GPT-3 的数据集为 **45TB**，其中 **Common Crawl** 占据大约 **60%**

## 预处理数据

1. 收集到的**原始数据**往往是**杂乱无章**的
2. 数据预处理 - 将**原始数据**转换成一直**更适合机器学习算法处理**的格式
3. 步骤 - 处理缺失值、异常值、数据标准化、特征选择等
4. GPT-3 的 **45TB** 的数据集，经过**预处理**，生成大概 **750GB** 的高质量数据

## 分割数据

1. 将数据分为**训练集**、**测试集**、验证集（可选）
2. **训练集**用于**训练模型**，而**测试集**用于**评估模型性能**
3. 评估的目的 - 检验模型对**未知数据**的**泛化**能力

## 选择模型

> 根据**问题类型**和**数据特点**，选择合适的机器学习模型

| 模型类型            | 学习类型     | 应用场景                   |
| ------------------- | ------------ | -------------------------- |
| 线性回归            | 监督学习     | 预测数值型数据             |
| 逻辑回归            | 监督学习     | 二分类问题                 |
| 决策树              | 监督学习     | 分类、回归问题             |
| 随机深林            | 监督学习     | 分类、回归、处理大量特征   |
| 支持向量机 - SVM    | 监督学习     | 分类、回归问题             |
| 梯度提升树          | 监督学习     | 分类、回归任务             |
| K 最近邻 - K-NN     | 监督学习     | 分类、回归、推荐系统       |
| 神经网络 / 深度学习 | **监督学习** | 图像识别、语音识别、NLP 等 |
| K-means 聚类        | 无监督学习   | 数据聚类                   |
| 层次聚类            | 无监督学习   | 数据聚类、发现数据层次结构 |
| 主成分分析 - PCA    | 无监督学习   | 降维、特征抽取             |
| 自编码器            | 无监督学习   | 降维、特征学习、数据压缩   |
| Q 学习              | 强化学习     | 无模型强化学习             |
| 深度 Q 网络 DQN     | 强化学习     | 处理高维状态空间           |
| 策略梯度            | 强化学习     | 直接学习决策策略           |

## 训练模型

1. 使用**训练数据**训练**选定的模型**
2. 模型会尝试**学习**数据中的**规律**和**关系**，以便在遇到**新数据**时能够作出准确的**预测**和**分类**
3. 模型可能会**自动**调整参数（权重）、自动测试、并使得效果**最好** - 成本
4. GPT-3 的单次训练成本为 **450 万美元**

## 评估模型

1. 使用**测试集**评估模型的**性能**
2. 常用的评估指标包括**准确率**、**召回率**、**F1 分数**等
3. 评估过程可能会揭示模型的**不足**之处，需要回到前面的步骤进行**调整**
4. 有各种各样的**模型性能评估基准** - MMLU / CEval / GSM8K 等

> https://www.superclueai.com/

![image-20240818095108938](https://llm-1253868755.cos.ap-guangzhou.myqcloud.com/image-20240818095108938.png)

## 调优模型

> 参数调优 + 模型优化

1. 根据模型在**测试集**上的表现，调整模型的**参数**或者进行其它优化，来提供模型**性能**
2. 调优过程可能反复进行**多次**，包含在**训练**和**微调**的过程中

## 部署模型

1. 当模型的**推理效果**达到**预期性能**后，可以将其部署到实际应用中
2. 部署后，模型将开始对**真实的数据**进行**推理**

## 监控维护

1. 模型部署后，需要**持续监控**其**性能**，并根据新收集到数据定期进行维护和更新
2. 随着**时间推移**，**数据分布**可能会发生变化，即**概念偏移**，可能会导致**模型性能下降**
3. 模型的**维护数据**
   - **模型开发者**主动进行收集
   - 在公开产品内由**用户**反馈 - ChatGPT / ChatGLM - 实时用户反馈 - **RLHF**

